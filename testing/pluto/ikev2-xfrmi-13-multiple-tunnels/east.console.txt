/testing/guestbin/swan-prep
east #
 ip addr add 192.0.21.254/24 dev eth0 2>/dev/null
east #
 ip addr add 192.0.22.254/24 dev eth0 2>/dev/null
east #
 ip addr add 192.0.23.254/24 dev eth0 2>/dev/null
east #
 ip addr add 192.0.24.254/24 dev eth0 2>/dev/null
east #
 ipsec start
Redirecting to: [initsystem]
east #
 /testing/pluto/bin/wait-until-pluto-started
east #
 ipsec auto --add north-east-21
002 "north-east-21": added IKEv2 connection
east #
 ipsec auto --add north-east-22
002 "north-east-22": added IKEv2 connection
east #
 ipsec auto --add north-east-23
002 "north-east-23": added IKEv2 connection
east #
 ipsec auto --add north-east-24
002 "north-east-24": added IKEv2 connection
east #
 echo "initdone"
initdone
east #
 ipsec whack --trafficstatus
006 #2: "north-east-21", type=ESP, add_time=1234567890, inBytes=168, outBytes=168, id='@north'
006 #4: "north-east-22", type=ESP, add_time=1234567890, inBytes=168, outBytes=168, id='@north'
006 #6: "north-east-23", type=ESP, add_time=1234567890, inBytes=168, outBytes=168, id='@north'
006 #8: "north-east-24", type=ESP, add_time=1234567890, inBytes=168, outBytes=168, id='@north'
east #
 ip -s link show ipsec1
Device "ipsec1" does not exist.
east #
 ip rule show
0:	from all lookup local
32766:	from all lookup main
32767:	from all lookup default
east #
 ip route show table 50
Error: ipv4: FIB table does not exist.
Dump terminated
east #
 ip route
default via 192.1.2.254 dev eth1
192.0.1.0/24 via 192.1.2.45 dev eth1
192.0.2.0/24 dev eth0 proto kernel scope link src 192.0.2.254
192.0.21.0/24 dev eth0 proto kernel scope link src 192.0.21.254
192.0.22.0/24 dev eth0 proto kernel scope link src 192.0.22.254
192.0.23.0/24 dev eth0 proto kernel scope link src 192.0.23.254
192.0.24.0/24 dev eth0 proto kernel scope link src 192.0.24.254
192.0.31.0/24 dev ipsec21 scope link
192.0.32.0/24 dev ipsec22 scope link
192.0.33.0/24 dev ipsec23 scope link
192.0.34.0/24 dev ipsec24 scope link
192.1.2.0/24 dev eth1 proto kernel scope link src 192.1.2.23
east #
 ip -d link show type xfrm
X: ipsec21@eth1: <NOARP,UP,LOWER_UP> mtu 1500 state UNKNOWN
    xfrm if_id 0x15 addrgenmode eui64 numtxqueues 1 numrxqueues 1 gso_max_size 65536 gso_max_segs 65535 
X: ipsec22@eth1: <NOARP,UP,LOWER_UP> mtu 1500 state UNKNOWN
    xfrm if_id 0x16 addrgenmode eui64 numtxqueues 1 numrxqueues 1 gso_max_size 65536 gso_max_segs 65535 
X: ipsec23@eth1: <NOARP,UP,LOWER_UP> mtu 1500 state UNKNOWN
    xfrm if_id 0x17 addrgenmode eui64 numtxqueues 1 numrxqueues 1 gso_max_size 65536 gso_max_segs 65535 
X: ipsec24@eth1: <NOARP,UP,LOWER_UP> mtu 1500 state UNKNOWN
    xfrm if_id 0x18 addrgenmode eui64 numtxqueues 1 numrxqueues 1 gso_max_size 65536 gso_max_segs 65535 
east #
 ../bin/check-for-core.sh
east #
 if [ -f /sbin/ausearch ]; then ausearch -r -m avc -ts recent ; fi
east #
 
