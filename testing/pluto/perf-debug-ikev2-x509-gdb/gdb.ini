set breakpoint pending on
set height unlimited

# set logging file gdb.log
# set logging redirect on
# set logging overwrite on
# set logging enable on

file /usr/local/libexec/ipsec/pluto

break PR_Lock
commands
 silent
 printf "thread %d ", $_thread
 bt 3
 c
end

break PR_Lock
commands
 silent
 printf "thread %d ", $_thread
 bt
 c
end
disable 2

break process_v2_IKE_AUTH_request
commands
 disable 1
 enable 2
 c
end

run --nofork --stderrlog --debug base
