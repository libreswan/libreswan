/testing/guestbin/swan-prep --userland strongswan
road #
 strongswan starter --debug-all
Starting strongSwan X.X.X IPsec [starter]...
Loading config setup
Loading conn 'roadnet-eastnet-ikev2'
  authby=secret
  auto=add
  esp=aes128-sha2_512
  ike=3des-md5-modp2048
  keyexchange=ikev2
  left=192.1.3.209
  leftid=@road
  leftsourceip=%config
  mobike=no
  right=192.1.2.23
  rightid=@east
  rightsubnet=0.0.0.0/0
found netkey IPsec stack
road #
 echo "initdone"
initdone
road #
 strongswan up roadnet-eastnet-ikev2
initiating IKE_SA roadnet-eastnet-ikev2[1] to 192.1.2.23
generating IKE_SA_INIT request 0 [ SA KE No N(NATD_S_IP) N(NATD_D_IP) ]
sending packet: from 192.1.3.209[500] to 192.1.2.23[500] (XXX bytes)
received packet: from 192.1.2.23[500] to 192.1.3.209[500] (XXX bytes)
parsed IKE_SA_INIT response 0 [ SA KE No N(NATD_S_IP) N(NATD_D_IP) CERTREQ N(MULT_AUTH) ]
received 1 cert requests for an unknown ca
authentication of 'road' (myself) with pre-shared key
establishing CHILD_SA roadnet-eastnet-ikev2
generating IKE_AUTH request 1 [ IDi N(INIT_CONTACT) IDr AUTH CPRQ(ADDR DNS) SA TSi TSr N(MULT_AUTH) N(EAP_ONLY) ]
sending packet: from 192.1.3.209[500] to 192.1.2.23[500] (XXX bytes)
received packet: from 192.1.2.23[500] to 192.1.3.209[500] (XXX bytes)
parsed IKE_AUTH response 1 [ IDr AUTH CPRP(ADDR DNS) SA TSi TSr N(AUTH_LFT) ]
authentication of 'east' with pre-shared key successful
IKE_SA roadnet-eastnet-ikev2[1] established between 192.1.3.209[road]...192.1.2.23[east]
scheduling reauthentication in XXXs
maximum IKE_SA lifetime XXXs
installing DNS server 192.168.0.1 to /etc/strongswan/resolv.conf
installing new virtual IP 192.0.2.1
connection 'roadnet-eastnet-ikev2' established successfully
road #
 ping -n -c 4 -I 192.0.1.254 192.0.2.254
bind: Cannot assign requested address
road #
 echo done
done
road #
 if [ -f /var/run/pluto/pluto.pid ]; then ipsec look ; fi
road #
 if [ -f /var/run/charon.pid ]; then strongswan statusall ; fi
Status of IKE charon daemon (strongSwan VERSION):
  uptime: XXX second, since YYY
  malloc sbrk XXXXXX,mmap X, used XXXXXX, free XXXXX
Listening IP addresses:
  192.1.3.209
Connections:
roadnet-eastnet-ikev2:  192.1.3.209...192.1.2.23  IKEv2
roadnet-eastnet-ikev2:   local:  [road] uses pre-shared key authentication
roadnet-eastnet-ikev2:   remote: [east] uses pre-shared key authentication
roadnet-eastnet-ikev2:   child:  dynamic === 0.0.0.0/0 TUNNEL
Security Associations (1 up, 0 connecting):
roadnet-eastnet-ikev2[1]: ESTABLISHED XXX second ago, 192.1.3.209[road]...192.1.2.23[east]
roadnet-eastnet-ikev2[1]: IKEv2 SPIs: SPISPI_i* SPISPI_r, pre-shared key reauthentication in 2 hours
roadnet-eastnet-ikev2[1]: IKE proposal: 3DES_CBC/HMAC_MD5_96/PRF_HMAC_MD5/MODP_2048
roadnet-eastnet-ikev2{1}:  INSTALLED, TUNNEL, ESP SPIs: SPISPI_i SPISPI_o
roadnet-eastnet-ikev2{1}:  AES_CBC_128/HMAC_SHA2_512_256, 0 bytes_i, 0 bytes_o, rekeying in 48 minutes
roadnet-eastnet-ikev2{1}:   192.0.2.1/32 === 0.0.0.0/0 
road #
road #
 if [ -n "`ls /tmp/core* 2>/dev/null`" ]; then echo CORE FOUND; mv /tmp/core* OUTPUT/; fi
road #
 if [ -f /sbin/ausearch ]; then ausearch -r -m avc -ts recent ; fi

