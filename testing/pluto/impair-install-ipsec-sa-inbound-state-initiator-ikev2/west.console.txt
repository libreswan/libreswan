/testing/guestbin/swan-prep
west #
 # confirm that the network is alive
west #
 ../../guestbin/wait-until-alive -I 192.0.1.254 192.0.2.254
destination -I 192.0.1.254 192.0.2.254 is alive
west #
 # ensure that clear text does not get through
west #
 iptables -A INPUT -i eth1 -s 192.0.2.0/24 -j DROP
west #
 iptables -I INPUT -m policy --dir in --pol ipsec -j ACCEPT
west #
 # confirm clear text does not get through
west #
 ../../guestbin/ping-once.sh --down -I 192.0.1.254 192.0.2.254
down
west #
 ipsec start
Redirecting to: [initsystem]
west #
 ../../guestbin/wait-until-pluto-started
west #
 ipsec add west-east
"west-east": added IKEv2 connection
west #
 ipsec whack --impair suppress_retransmits
west #
 ipsec whack --impair revival
west #
 ipsec route west-east
west #
 ipsec whack --impair install_ipsec_sa_inbound_state
west #
 # Initiate; during IKE_AUTH the child should fail and the connection
west #
 # put on to the revival queue
west #
 ipsec up west-east
"west-east" #1: initiating IKEv2 connection to 192.1.2.23 using UDP
"west-east" #1: sent IKE_SA_INIT request to 192.1.2.23:UDP/500
"west-east" #1: processed IKE_SA_INIT response from 192.1.2.23:UDP/500 {cipher=AES_GCM_16_256 integ=n/a prf=HMAC_SHA2_512 group=DH19}, initiating IKE_AUTH
"west-east" #1: sent IKE_AUTH request to 192.1.2.23:UDP/500
"west-east" #1: initiator established IKE SA; authenticated peer using authby=secret and ID_FQDN '@east'
"west-east" #2: IMPAIR: kernel: install_ipsec_sa_inbound_state in setup_half_kernel_state()
"west-east" #2: CHILD SA encountered fatal error: INVALID_SYNTAX
"west-east" #1: encountered fatal error in state STATE_V2_ESTABLISHED_IKE_SA
"west-east" #2: connection is supposed to remain up; revival attempt 1 scheduled in 0 seconds
"west-east" #2: IMPAIR: revival: skip scheduling revival event
ERROR: "west-east" #2: kernel: xfrm XFRM_MSG_DELPOLICY delete response for flow (in): No such file or directory (errno 2)
"west-east" #2: kernel: replace_ipsec_with_bare_kernel_policy() inbound delete failed
ERROR: "west-east" #2: netlink response for Del SA esp.ESPSPIi@192.1.2.23: No such process (errno 3)
ERROR: "west-east" #2: netlink response for Del SA esp.ESPSPIi@192.1.2.45: No such process (errno 3)
"west-east" #1: deleting IKE SA (ESTABLISHED_IKE_SA) and NOT sending notification
west #
 # expect the on-demand kernel policy
west #
 ../../guestbin/ipsec-kernel-policy.sh
src 192.0.1.0/24 dst 192.0.2.0/24
	dir out priority PRIORITY ptype main
	tmpl src 0.0.0.0 dst 0.0.0.0
		proto esp reqid 0 mode transport
west #
 # Trigger an acquire; this fast track the revival using
west #
 # CREATE_CHILD_SA and again it will fail
west #
 ../../guestbin/ping-once.sh --down -I 192.0.1.254 192.0.2.254
down
west #
 ../../guestbin/wait-for-pluto.sh '#3: IMPAIR: revival'
timeout waiting 30 seconds for cat /tmp/pluto.log to match #3: IMPAIR: revival
output: |    last transform: v2_TRANSFORM_NON_LAST (0x3)
output: |    length: 12 (00 0c)
output: |    IKEv2 transform type: IKEv2_TRANS_TYPE_ENCR (0x1)
output: |    IKEv2 transform ID: AES_GCM_C (0x14)
output: | ******parse IKEv2 Attribute Substructure Payload:
output: |    af+type: AF+IKEv2_KEY_LENGTH (0x800e)
output: |    length/value: 256 (01 00)
output: | remote proposal 1 transform 0 (ENCR=AES_GCM_C_256) matches local proposal 1 type 1 (ENCR) transform 0
output: | *****parse IKEv2 Transform Substructure Payload:
output: |    last transform: v2_TRANSFORM_NON_LAST (0x3)
output: |    length: 8 (00 08)
output: |    IKEv2 transform type: IKEv2_TRANS_TYPE_PRF (0x2)
output: |    IKEv2 transform ID: PRF_HMAC_SHA2_512 (0x7)
output: | remote proposal 1 transform 1 (PRF=HMAC_SHA2_512) matches local proposal 1 type 2 (PRF) transform 0
output: | *****parse IKEv2 Transform Substructure Payload:
output: |    last transform: v2_TRANSFORM_LAST (0x0)
output: |    length: 8 (00 08)
output: |    IKEv2 transform type: IKEv2_TRANS_TYPE_DH (0x4)
output: |    IKEv2 transform ID: OAKLEY_GROUP_ECP_256 (0x13)
output: | remote proposal 1 transform 2 (DH=ECP_256) matches local proposal 1 type 4 (DH) transform 0
output: | remote proposal 1 proposed transforms: ENCR+PRF+DH; matched: ENCR+PRF+DH; unmatched: none
output: | comparing remote proposal 1 containing ENCR+PRF+DH transforms to local proposal 1; required: ENCR+PRF+DH; optional: INTEG; matched: ENCR+PRF+DH
output: | remote proposal 1 matches local proposal 1
output: | remote accepted the proposal 1:IKE:ENCR=AES_GCM_C_256;PRF=HMAC_SHA2_512;DH=ECP_256[first-match]
output: | converting proposal to internal trans attrs
output: | natd_hash: hasher=0x55b4e4730c80(20)
output: | natd_hash: icookie=
output: |   aa 3a c6 a2  e1 65 10 22                             .:...e."
output: | natd_hash: rcookie=
output: |   9f f8 fa 9e  d9 73 44 e5                             .....sD.
output: | natd_hash: ip=
output: |   c0 01 02 2d                                          ...-
output: | natd_hash: port=
output: |   01 f4                                                ..
output: | natd_hash: hash=
output: |   f9 17 05 fa  c3 a9 33 e1  c0 ff c7 4b  20 a2 c9 2f   ......3....K ../
output: |   59 68 9b 7d                                          Yh.}
output: | natd_hash: hasher=0x55b4e4730c80(20)
output: | natd_hash: icookie=
output: |   aa 3a c6 a2  e1 65 10 22                             .:...e."
output: | natd_hash: rcookie=
output: |   9f f8 fa 9e  d9 73 44 e5                             .....sD.
output: | natd_hash: ip=
output: |   c0 01 02 17                                          ....
output: | natd_hash: port=
output: |   01 f4                                                ..
output: | natd_hash: hash=
output: |   4c 75 17 82  50 55 d4 d8  0b e2 19 f9  05 57 08 4d   Lu..PU.......W.M
output: |   a0 6a 9f 8c                                          .j..
output: | NAT_TRAVERSAL encaps using auto-detect
output: | NAT_TRAVERSAL this end is NOT behind NAT
output: | NAT_TRAVERSAL that end is NOT behind NAT
output: | NAT_TRAVERSAL nat-keepalive enabled 192.1.2.23:500
output: | INTERMEDIATE_EXCHANGE_SUPPORTED neither requested nor accepted
output: | submitting DH shared secret for #3/#3 (process_v2_IKE_SA_INIT_response() +1619 programs/pluto/ikev2_ike_sa_init.c)
output: | struct dh_local_secret: addref @0x7f37fdf2bfd8(1->2) (submit_dh_shared_secret() +212 programs/pluto/crypt_dh.c)
output: | job: newref @0x7f37fdf05f98(0->1) (submit_task() +331 programs/pluto/server_pool.c)
output: | clone logger: newref @0x7f37fdf09fc8(0->1) (submit_task() +358 programs/pluto/server_pool.c)
output: | job 4 helper 0 #3 process_v2_IKE_SA_INIT_response (dh): added to pending queue
output: | event_schedule_where: newref EVENT_CRYPTO_TIMEOUT-pe@0x7f37fdf0bfa8 timeout in 60 seconds for #3
output: | tt: newref @0x7f37fdf0df68(0->1) (schedule_timeout() +557 programs/pluto/server.c)
output: | #3 complete_v2_state_transition() PARENT_I1->PARENT_I2 with status STF_SUSPEND
output: | suspend: saving MD@0x7f37fe0f36f8 in state #3 (complete_v2_state_transition() +2702 programs/pluto/ikev2.c)
output: | struct msg_digest: addref @0x7f37fe0f36f8(1->2) (complete_v2_state_transition() +2702 programs/pluto/ikev2.c)
output: | #3 is busy; has suspended MD 0x7f37fe0f36f8
output: |   #3 spent 1.64 (11.6) milliseconds in processing: Initiator: process IKE_SA_INIT reply, initiate IKE_AUTH or IKE_INTERMEDIATE in v2_dispatch()
output: | #3 spent 2.37 (22.3) milliseconds in process_v2_IKE_SA_INIT()
output: | packet from 192.1.2.23:500: delref @0x7f37fe0f36f8(2->1) (process_iface_packet() +296 programs/pluto/demux.c)
output: | spent 2.38 (22.5) milliseconds in process_iface_packet() reading and processing packet
output: | job 4 helper 1 #3 process_v2_IKE_SA_INIT_response (dh): started
output: | temp: newref @0x7f37fe081f80(0->1) (nss_ecp_calc_shared_secret() +193 lib/libswan/ike_alg_dh_nss_ecp_ops.c)
output: |     result: newref ecp-shared-secret-key@0x7f37feb0cf80 (32-bytes, EXTRACT_KEY_FROM_KEY)(nss_ecp_calc_shared_secret() +203 lib/libswan/ike_alg_dh_nss_ecp_ops.c)
output: | nss_ecp_calc_shared_secret: delref temp-key@0x7f37fe081f80
output: | job 4 helper 1 #3 process_v2_IKE_SA_INIT_response (dh): finished
output: | "west-east" #3: spent 0.865 (2.14) milliseconds in job 4 helper 1 #3 process_v2_IKE_SA_INIT_response (dh)
output: | scheduling resume sending job back to main thread for #3
output: | tt: newref @0x7f37fdf11f68(0->1) (schedule_timeout() +557 programs/pluto/server.c)
output: | helper 1: waiting for work
output: | processing resume sending job back to main thread for #3
output: | suspend: restoring MD@0x7f37fe0f36f8 from state #3 (resume_handler() +641 programs/pluto/server.c)
output: | job 4 helper 1 #3 process_v2_IKE_SA_INIT_response (dh): calling state's callback function
output: | completing DH shared secret for #3/#3
output: | complete_dh_shared_secret: delref st_dh_shared_secret-key@NULL
output: | calculating skeyseed using prf=HMAC_SHA2_512 integ=NONE cipherkey-size=32 salt-size=4
output: |     result: newref skeyseed-key@0x7f37fe081f80 (64-bytes, NSS_IKE_PRF_PLUS_DERIVE)(ike_sa_skeyseed() +106 lib/libswan/ike_alg_prf_ikev2_nss_ops.c)
output: |     result: newref keymat-key@0x7f37fea00f80 (264-bytes, EXTRACT_KEY_FROM_KEY)(prfplus_key_data() +61 lib/libswan/ike_alg_prf_ikev2_nss_ops.c)
output: | calc_skeyseed_v2: delref skeyseed-key@0x7f37fe081f80
output: |     result: newref SK_d-key@0x7f37fe081f80 (64-bytes, EXTRACT_KEY_FROM_KEY)(calc_skeyseed_v2() +115 programs/pluto/crypt_dh_v2.c)
output: |     result: newref SK_ei-key@0x7f37febc4f80 (32-bytes, AES_GCM)(calc_skeyseed_v2() +135 programs/pluto/crypt_dh_v2.c)
output: |     result: newref initiator salt-key@0x7f37fea15f80 (4-bytes, EXTRACT_KEY_FROM_KEY)(calc_skeyseed_v2() +142 programs/pluto/crypt_dh_v2.c)
output: | initiator salt: newref slot-key@0x7f37feb06f80 (4-bytes, EXTRACT_KEY_FROM_KEY)
output: | initiator salt: delref slot-key-key@0x7f37feb06f80
output: | calc_skeyseed_v2: delref initiator-salt-key-key@0x7f37fea15f80
output: |     result: newref SK_er_k-key@0x7f37fea15f80 (32-bytes, AES_GCM)(calc_skeyseed_v2() +156 programs/pluto/crypt_dh_v2.c)
output: |     result: newref responder salt-key@0x7f37febb5f80 (4-bytes, EXTRACT_KEY_FROM_KEY)(calc_skeyseed_v2() +163 programs/pluto/crypt_dh_v2.c)
output: | responder salt: newref slot-key@0x7f37feb06f80 (4-bytes, EXTRACT_KEY_FROM_KEY)
output: | responder salt: delref slot-key-key@0x7f37feb06f80
output: | calc_skeyseed_v2: delref responder-salt-key-key@0x7f37febb5f80
output: |     result: newref SK_pi-key@0x7f37febb5f80 (64-bytes, EXTRACT_KEY_FROM_KEY)(calc_skeyseed_v2() +172 programs/pluto/crypt_dh_v2.c)
output: | chunk_SK_pi: newref slot-key@0x7f37feb06f80 (64-bytes, EXTRACT_KEY_FROM_KEY)
output: | chunk_SK_pi: delref slot-key-key@0x7f37feb06f80
output: |     result: newref SK_pr-key@0x7f37feb0ef80 (64-bytes, EXTRACT_KEY_FROM_KEY)(calc_skeyseed_v2() +180 programs/pluto/crypt_dh_v2.c)
output: | chunk_SK_pr: newref slot-key@0x7f37feb06f80 (64-bytes, EXTRACT_KEY_FROM_KEY)
output: | chunk_SK_pr: delref slot-key-key@0x7f37feb06f80
output: | calc_skeyseed_v2: delref finalkey-key@0x7f37fea00f80
output: | State DB: re-hashing IKEv2 state #3 IKE SPIr
output: | no CERTREQ
output: "west-east" #3: processed IKE_SA_INIT response from 192.1.2.23:UDP/500 {cipher=AES_GCM_16_256 integ=n/a prf=HMAC_SHA2_512 group=DH19}, initiating IKE_AUTH
output: | initiate_v2_IKE_AUTH_request() for #3 STATE_V2_PARENT_I1: g^{xy} calculated, sending IKE_AUTH
output: |     result: newref clone-key@0x7f37fea00f80 (64-bytes, SHA512_HMAC)(init_symkey() +101 lib/libswan/ike_alg_prf_mac_nss_ops.c)
output: | IDi: delref clone-key@0x7f37fea00f80
output: | ikev2_calculate_psk_sighash() called for STATE_V2_PARENT_I1 to LOCAL_PERSPECTIVE PSK with authby=secret
output: | lsw_get_secret() using IDs for @west->@east of kind SECRET_PSK
output: | line 1: key type SECRET_PSK(@west) to type SECRET_PSK
output: | 1: compared key @west to @west / @east -> 8
output: | 2: compared key @east to @west / @east -> c
output: |   match=c
output: |   match c beats previous best_match 0 match=0x7f37fe017f68 (line=1)
output: | concluding with best_match=c best=0x7f37fe017f68 (lineno=1)
output: |     result: newref pss-key@0x7f37fe098f80 (52-bytes, EXTRACT_KEY_FROM_KEY)(merge_symkey_bytes() +222 lib/libswan/crypt_symkey.c)
output: |     result: newref pss-key@0x7f37fea00f80 (36-bytes, SHA512_HMAC)(psk_auth() +201 lib/libswan/ike_alg_prf_ikev2_nss_ops.c)
output: | pss: delref tmp-key@0x7f37fe098f80
output: |     result: newref prf(Shared Secret, "Key Pad for IKEv2")-key@0x7f37fe098f80 (64-bytes, SHA512_HMAC)(psk_auth() +228 lib/libswan/ike_alg_prf_ikev2_nss_ops.c)
output: | psk pss_key: delref pss_key-key@0x7f37fea00f80
output: |     result: newref clone-key@0x7f37fea00f80 (64-bytes, SHA512_HMAC)(init_symkey() +101 lib/libswan/ike_alg_prf_mac_nss_ops.c)
output: | <signed-octets> = prf(<prf-psk>, <msg octets>): delref clone-key@0x7f37fea00f80
output: | psk_auth: delref prf-psk-key@0x7f37fe098f80
output: | opening output PBS IKE_AUTH request
output: | **emit ISAKMP Message:
output: |    initiator SPI: aa 3a c6 a2  e1 65 10 22
output: |    responder SPI: 9f f8 fa 9e  d9 73 44 e5
output: |    next payload type: ISAKMP_NEXT_NONE (0x0)
output: |    ISAKMP version: IKEv2 version 2.0 (rfc4306/rfc5996) (0x20)
output: |    exchange type: ISAKMP_v2_IKE_AUTH (0x23)
output: |    flags: ISAKMP_FLAG_v2_IKE_INIT (0x8)
output: |    Message ID: 1 (00 00 00 01)
output: | next payload chain: saving message location 'ISAKMP Message'.'next payload type'
output: | ***emit IKEv2 Encryption Payload:
output: |    next payload type: ISAKMP_NEXT_v2NONE (0x0)
output: |    flags: none (0x0)
output: | next payload chain: setting previous 'ISAKMP Message'.'next payload type' to current IKEv2 Encryption Payload (46:ISAKMP_NEXT_v2SK)
output: | next payload chain: saving location 'IKEv2 Encryption Payload'.'next payload type' in 'IKE_AUTH request'
output: | emitting 8 zero bytes of IV into IKEv2 Encryption Payload
output: | IKEv2 CERT: not sending cert: local leftauthby=PSK does not have RSA or ECDSA
output: | IDr payload will be sent
output: | ****emit IKEv2 Identification - Initiator - Payload:
output: |    next payload type: ISAKMP_NEXT_v2NONE (0x0)
output: |    flags: none (0x0)
output: |    ID type: ID_FQDN (0x2)
output: |    reserved: 00 00 00
output: | next payload chain: setting previous 'IKEv2 Encryption Payload'.'next payload type' to current IKEv2 Identification - Initiator - Payload (35:ISAKMP_NEXT_v2IDi)
output: | next payload chain: saving location 'IKEv2 Identification - Initiator - Payload'.'next payload type' in 'IKE_AUTH request'
output: | emitting 4 raw bytes of my identity into IKEv2 Identification - Initiator - Payload
output: | my identity: 77 65 73 74
output: | emitting length of IKEv2 Identification - Initiator - Payload: 12
output: | IKEv2 CERTREQ: send a cert request?
output: | IKEv2 CERTREQ: responder has no auth method requiring them to send back their cert
output: | ****emit IKEv2 Identification - Responder - Payload:
output: |    next payload type: ISAKMP_NEXT_v2NONE (0x0)
output: |    flags: none (0x0)
output: |    ID type: ID_FQDN (0x2)
output: |    reserved: 00 00 00
output: | next payload chain: setting previous 'IKEv2 Identification - Initiator - Payload'.'next payload type' to current IKEv2 Identification - Responder - Payload (36:ISAKMP_NEXT_v2IDr)
output: | next payload chain: saving location 'IKEv2 Identification - Responder - Payload'.'next payload type' in 'IKE_AUTH request'
output: | emitting 4 raw bytes of their IDr into IKEv2 Identification - Responder - Payload
output: | their IDr: 65 61 73 74
output: | emitting length of IKEv2 Identification - Responder - Payload: 12
output: | not sending INITIAL_CONTACT
output: | ****emit IKEv2 Authentication Payload:
output: |    next payload type: ISAKMP_NEXT_v2NONE (0x0)
output: |    flags: none (0x0)
output: |    auth method: IKEv2_AUTH_SHARED (0x2)
output: | next payload chain: setting previous 'IKEv2 Identification - Responder - Payload'.'next payload type' to current IKEv2 Authentication Payload (39:ISAKMP_NEXT_v2AUTH)
output: | next payload chain: saving location 'IKEv2 Authentication Payload'.'next payload type' in 'IKE_AUTH request'
output: | emitting 64 raw bytes of signature into IKEv2 Authentication Payload
output: |   c9 f3 e1 c7  ef cd 18 94  dc 2b 76 e8  4e e3 55 f3   .........+v.N.U.
output: |   25 fb 5a 22  a3 24 7d 93  a7 83 39 27  9d 83 61 f9   %.Z".$}...9'..a.
output: |   b7 8d b8 c1  0e b3 72 e2  6f b2 58 77  9d f2 14 c6   ......r.o.Xw....
output: |   c6 9e 80 14  95 ff 37 10  91 47 aa 94  46 50 a1 72   ......7..G..FP.r
output: | emitting length of IKEv2 Authentication Payload: 72
output: | "west-east": no whack to attach
output: | pending: first_pending() ike 0x7f37fe071348 pending 0x7f37fe083fa8 connection 0x7f37fea9da78 ike 0x7f37fe071348
output: | struct iface_endpoint: addref @0x7f37feaabf38(3->4) (duplicate_state() +1198 programs/pluto/state.c)
output: | alloc logger: newref @0x7f37fdf78fc8(0->1) (duplicate_state() +1206 programs/pluto/state.c)
output: |  #0: no whack to attach
output: | "west-east": addref @0x7f37fea9da78(3->4)  #4:  (new_state() +491 programs/pluto/state.c)
output: | creating state object #4 at 0x7f37fdf23348
output: | pstats #4 ikev2.child started
output: | duplicating state object #3 "west-east" as #4 for IPSEC SA
output: | #4 setting local endpoint to 192.1.2.45:500 from #3.st_localport (duplicate_state() +1220 programs/pluto/state.c)
output: | duplicate_state: addref st_skeyid_nss-key@NULL
output: | duplicate_state: addref st_skey_d_nss-key@0x7f37fe081f80
output: | duplicate_state: addref st_skey_ai_nss-key@NULL
output: | duplicate_state: addref st_skey_ar_nss-key@NULL
output: | duplicate_state: addref st_skey_ei_nss-key@0x7f37febc4f80
output: | duplicate_state: addref st_skey_er_nss-key@0x7f37fea15f80
output: | duplicate_state: addref st_skey_pi_nss-key@0x7f37febb5f80
output: | duplicate_state: addref st_skey_pr_nss-key@0x7f37feb0ef80
output: | duplicate_state: addref st_enc_key_nss-key@NULL
output: | child state #4: UNDEFINED(ignore) => IKE_AUTH_CHILD_I0(ignore)
output: | #4.st_v2_transition NULL -> IKE_AUTH_CHILD_I0->ESTABLISHED_CHILD_SA (new_v2_child_sa() +1296 programs/pluto/state.c)
output: | "west-east": addref @0x7f37fea9da78(4->5) "west-east" #4:  (dispatch() +2436 programs/pluto/routing.c)
output: | "west-east" #4: routing: start INITIATED, ROUTED_NEGOTIATION, PERMANENT; IKE #3 (PARENT_I1) Child #4 (IKE_AUTH_CHILD_I0) by=IKE; $1@0x7f37fea9da78; routing_sa #3 negotiating_ike_sa #3 (initiate_v2_IKE_AUTH_request_signature_continue() +334 programs/pluto/ikev2_ike_auth.c)
output: | "west-east" #4: routing:   Child SA's IKE SA matches .routing_sa
output: | "west-east" #4: routing: stop INITIATED, ROUTED_NEGOTIATION, PERMANENT; ok=yes; routing_sa #3->#4 negotiating_ike_sa #3 negotiating_child_sa #0->#4 (initiate_v2_IKE_AUTH_request_signature_continue() +334 programs/pluto/ikev2_ike_auth.c)
output: | "west-east": delref @0x7f37fea9da78(5->4) "west-east" #4:  (dispatch() +2450 programs/pluto/routing.c)
output: | "west-east": releasing whack (but there are none) (initiate_v2_IKE_AUTH_request_signature_continue() +340 programs/pluto/ikev2_ike_auth.c)
output: | "west-east" #4: routing:  kernel_ops_get_ipsec_spi() 192.1.2.23-ESP->192.1.2.45 reqid=4005 [1000,ffffffff] for SPI ...
output: | sendrecv_xfrm_msg() sending 22 Get SPI SPI
output: | sendrecv_xfrm_msg() recvfrom() returned 256 bytes
output: | "west-east" #4: routing:   ... allocated 2ba36575 for SPI
output: | Emitting ikev2_proposals ...
output: | ****emit IKEv2 Security Association Payload:
output: |    next payload type: ISAKMP_NEXT_v2NONE (0x0)
output: |    flags: none (0x0)
output: | next payload chain: setting previous 'IKEv2 Authentication Payload'.'next payload type' to current IKEv2 Security Association Payload (33:ISAKMP_NEXT_v2SA)
output: | next payload chain: saving location 'IKEv2 Security Association Payload'.'next payload type' in 'IKE_AUTH request'
output: | discard INTEG=NONE when counting transforms (multiple 0; allow single 0)
output: | discard DH=NONE when counting transforms (multiple 0; allow single 0)
output: | *****emit IKEv2 Proposal Substructure Payload:
output: |    last proposal: v2_PROPOSAL_NON_LAST (0x2)
output: |    prop #: 1 (01)
output: |    proto ID: IKEv2_SEC_PROTO_ESP (0x3)
output: |    spi size: 4 (04)
output: |    # transforms: 3 (03)
output: | last substructure: saving location 'IKEv2 Security Association Payload'.'IKEv2 Proposal Substructure Payload'.'last proposal'
output: | emitting 4 raw bytes of our spi into IKEv2 Proposal Substructure Payload
output: | our spi: 2b a3 65 75
output: | ******emit IKEv2 Transform Substructure Payload:
output: |    last transform: v2_TRANSFORM_NON_LAST (0x3)
output: |    IKEv2 transform type: IKEv2_TRANS_TYPE_ENCR (0x1)
output: |    IKEv2 transform ID: AES_GCM_C (0x14)
output: | last substructure: saving location 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform'
output: | *******emit IKEv2 Attribute Substructure Payload:
output: |    af+type: AF+IKEv2_KEY_LENGTH (0x800e)
output: |    length/value: 256 (01 00)
output: | emitting length of IKEv2 Transform Substructure Payload: 12
output: | discard INTEG=NONE when emitting proposal (multiple 0; allow single 0)
output: | discard DH=NONE when emitting proposal (multiple 0; allow single 0)
output: | ******emit IKEv2 Transform Substructure Payload:
output: |    last transform: v2_TRANSFORM_NON_LAST (0x3)
output: |    IKEv2 transform type: IKEv2_TRANS_TYPE_ESN (0x5)
output: |    IKEv2 transform ID: IKEv2_ESN_YES (0x1)
output: | last substructure: checking 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform' containing v2_TRANSFORM_NON_LAST (0x3) is v2_TRANSFORM_NON_LAST (0x3)
output: | last substructure: saving location 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform'
output: | emitting length of IKEv2 Transform Substructure Payload: 8
output: | ******emit IKEv2 Transform Substructure Payload:
output: |    last transform: v2_TRANSFORM_LAST (0x0)
output: |    IKEv2 transform type: IKEv2_TRANS_TYPE_ESN (0x5)
output: |    IKEv2 transform ID: IKEv2_ESN_NO (0x0)
output: | last substructure: checking 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform' containing v2_TRANSFORM_NON_LAST (0x3) is v2_TRANSFORM_NON_LAST (0x3)
output: | last substructure: saving location 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform'
output: | emitting length of IKEv2 Transform Substructure Payload: 8
output: | emitting length of IKEv2 Proposal Substructure Payload: 40
output: | last substructure: checking 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform' is 0
output: | discard INTEG=NONE when counting transforms (multiple 0; allow single 0)
output: | discard DH=NONE when counting transforms (multiple 0; allow single 0)
output: | *****emit IKEv2 Proposal Substructure Payload:
output: |    last proposal: v2_PROPOSAL_NON_LAST (0x2)
output: |    prop #: 2 (02)
output: |    proto ID: IKEv2_SEC_PROTO_ESP (0x3)
output: |    spi size: 4 (04)
output: |    # transforms: 3 (03)
output: | last substructure: checking 'IKEv2 Security Association Payload'.'IKEv2 Proposal Substructure Payload'.'last proposal' containing v2_PROPOSAL_NON_LAST (0x2) is v2_PROPOSAL_NON_LAST (0x2)
output: | last substructure: saving location 'IKEv2 Security Association Payload'.'IKEv2 Proposal Substructure Payload'.'last proposal'
output: | emitting 4 raw bytes of our spi into IKEv2 Proposal Substructure Payload
output: | our spi: 2b a3 65 75
output: | ******emit IKEv2 Transform Substructure Payload:
output: |    last transform: v2_TRANSFORM_NON_LAST (0x3)
output: |    IKEv2 transform type: IKEv2_TRANS_TYPE_ENCR (0x1)
output: |    IKEv2 transform ID: AES_GCM_C (0x14)
output: | last substructure: saving location 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform'
output: | *******emit IKEv2 Attribute Substructure Payload:
output: |    af+type: AF+IKEv2_KEY_LENGTH (0x800e)
output: |    length/value: 128 (00 80)
output: | emitting length of IKEv2 Transform Substructure Payload: 12
output: | discard INTEG=NONE when emitting proposal (multiple 0; allow single 0)
output: | discard DH=NONE when emitting proposal (multiple 0; allow single 0)
output: | ******emit IKEv2 Transform Substructure Payload:
output: |    last transform: v2_TRANSFORM_NON_LAST (0x3)
output: |    IKEv2 transform type: IKEv2_TRANS_TYPE_ESN (0x5)
output: |    IKEv2 transform ID: IKEv2_ESN_YES (0x1)
output: | last substructure: checking 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform' containing v2_TRANSFORM_NON_LAST (0x3) is v2_TRANSFORM_NON_LAST (0x3)
output: | last substructure: saving location 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform'
output: | emitting length of IKEv2 Transform Substructure Payload: 8
output: | ******emit IKEv2 Transform Substructure Payload:
output: |    last transform: v2_TRANSFORM_LAST (0x0)
output: |    IKEv2 transform type: IKEv2_TRANS_TYPE_ESN (0x5)
output: |    IKEv2 transform ID: IKEv2_ESN_NO (0x0)
output: | last substructure: checking 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform' containing v2_TRANSFORM_NON_LAST (0x3) is v2_TRANSFORM_NON_LAST (0x3)
output: | last substructure: saving location 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform'
output: | emitting length of IKEv2 Transform Substructure Payload: 8
output: | emitting length of IKEv2 Proposal Substructure Payload: 40
output: | last substructure: checking 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform' is 0
output: | discard INTEG=NONE when counting transforms (multiple 0; allow single 0)
output: | discard DH=NONE when counting transforms (multiple 0; allow single 0)
output: | *****emit IKEv2 Proposal Substructure Payload:
output: |    last proposal: v2_PROPOSAL_NON_LAST (0x2)
output: |    prop #: 3 (03)
output: |    proto ID: IKEv2_SEC_PROTO_ESP (0x3)
output: |    spi size: 4 (04)
output: |    # transforms: 3 (03)
output: | last substructure: checking 'IKEv2 Security Association Payload'.'IKEv2 Proposal Substructure Payload'.'last proposal' containing v2_PROPOSAL_NON_LAST (0x2) is v2_PROPOSAL_NON_LAST (0x2)
output: | last substructure: saving location 'IKEv2 Security Association Payload'.'IKEv2 Proposal Substructure Payload'.'last proposal'
output: | emitting 4 raw bytes of our spi into IKEv2 Proposal Substructure Payload
output: | our spi: 2b a3 65 75
output: | ******emit IKEv2 Transform Substructure Payload:
output: |    last transform: v2_TRANSFORM_NON_LAST (0x3)
output: |    IKEv2 transform type: IKEv2_TRANS_TYPE_ENCR (0x1)
output: |    IKEv2 transform ID: CHACHA20_POLY1305 (0x1c)
output: | last substructure: saving location 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform'
output: | emitting length of IKEv2 Transform Substructure Payload: 8
output: | discard INTEG=NONE when emitting proposal (multiple 0; allow single 0)
output: | discard DH=NONE when emitting proposal (multiple 0; allow single 0)
output: | ******emit IKEv2 Transform Substructure Payload:
output: |    last transform: v2_TRANSFORM_NON_LAST (0x3)
output: |    IKEv2 transform type: IKEv2_TRANS_TYPE_ESN (0x5)
output: |    IKEv2 transform ID: IKEv2_ESN_YES (0x1)
output: | last substructure: checking 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform' containing v2_TRANSFORM_NON_LAST (0x3) is v2_TRANSFORM_NON_LAST (0x3)
output: | last substructure: saving location 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform'
output: | emitting length of IKEv2 Transform Substructure Payload: 8
output: | ******emit IKEv2 Transform Substructure Payload:
output: |    last transform: v2_TRANSFORM_LAST (0x0)
output: |    IKEv2 transform type: IKEv2_TRANS_TYPE_ESN (0x5)
output: |    IKEv2 transform ID: IKEv2_ESN_NO (0x0)
output: | last substructure: checking 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform' containing v2_TRANSFORM_NON_LAST (0x3) is v2_TRANSFORM_NON_LAST (0x3)
output: | last substructure: saving location 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform'
output: | emitting length of IKEv2 Transform Substructure Payload: 8
output: | emitting length of IKEv2 Proposal Substructure Payload: 36
output: | last substructure: checking 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform' is 0
output: | discard DH=NONE when counting transforms (multiple 0; allow single 0)
output: | *****emit IKEv2 Proposal Substructure Payload:
output: |    last proposal: v2_PROPOSAL_NON_LAST (0x2)
output: |    prop #: 4 (04)
output: |    proto ID: IKEv2_SEC_PROTO_ESP (0x3)
output: |    spi size: 4 (04)
output: |    # transforms: 5 (05)
output: | last substructure: checking 'IKEv2 Security Association Payload'.'IKEv2 Proposal Substructure Payload'.'last proposal' containing v2_PROPOSAL_NON_LAST (0x2) is v2_PROPOSAL_NON_LAST (0x2)
output: | last substructure: saving location 'IKEv2 Security Association Payload'.'IKEv2 Proposal Substructure Payload'.'last proposal'
output: | emitting 4 raw bytes of our spi into IKEv2 Proposal Substructure Payload
output: | our spi: 2b a3 65 75
output: | ******emit IKEv2 Transform Substructure Payload:
output: |    last transform: v2_TRANSFORM_NON_LAST (0x3)
output: |    IKEv2 transform type: IKEv2_TRANS_TYPE_ENCR (0x1)
output: |    IKEv2 transform ID: AES_CBC (0xc)
output: | last substructure: saving location 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform'
output: | *******emit IKEv2 Attribute Substructure Payload:
output: |    af+type: AF+IKEv2_KEY_LENGTH (0x800e)
output: |    length/value: 256 (01 00)
output: | emitting length of IKEv2 Transform Substructure Payload: 12
output: | ******emit IKEv2 Transform Substructure Payload:
output: |    last transform: v2_TRANSFORM_NON_LAST (0x3)
output: |    IKEv2 transform type: IKEv2_TRANS_TYPE_INTEG (0x3)
output: |    IKEv2 transform ID: AUTH_HMAC_SHA2_512_256 (0xe)
output: | last substructure: checking 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform' containing v2_TRANSFORM_NON_LAST (0x3) is v2_TRANSFORM_NON_LAST (0x3)
output: | last substructure: saving location 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform'
output: | emitting length of IKEv2 Transform Substructure Payload: 8
output: | ******emit IKEv2 Transform Substructure Payload:
output: |    last transform: v2_TRANSFORM_NON_LAST (0x3)
output: |    IKEv2 transform type: IKEv2_TRANS_TYPE_INTEG (0x3)
output: |    IKEv2 transform ID: AUTH_HMAC_SHA2_256_128 (0xc)
output: | last substructure: checking 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform' containing v2_TRANSFORM_NON_LAST (0x3) is v2_TRANSFORM_NON_LAST (0x3)
output: | last substructure: saving location 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform'
output: | emitting length of IKEv2 Transform Substructure Payload: 8
output: | discard DH=NONE when emitting proposal (multiple 0; allow single 0)
output: | ******emit IKEv2 Transform Substructure Payload:
output: |    last transform: v2_TRANSFORM_NON_LAST (0x3)
output: |    IKEv2 transform type: IKEv2_TRANS_TYPE_ESN (0x5)
output: |    IKEv2 transform ID: IKEv2_ESN_YES (0x1)
output: | last substructure: checking 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform' containing v2_TRANSFORM_NON_LAST (0x3) is v2_TRANSFORM_NON_LAST (0x3)
output: | last substructure: saving location 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform'
output: | emitting length of IKEv2 Transform Substructure Payload: 8
output: | ******emit IKEv2 Transform Substructure Payload:
output: |    last transform: v2_TRANSFORM_LAST (0x0)
output: |    IKEv2 transform type: IKEv2_TRANS_TYPE_ESN (0x5)
output: |    IKEv2 transform ID: IKEv2_ESN_NO (0x0)
output: | last substructure: checking 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform' containing v2_TRANSFORM_NON_LAST (0x3) is v2_TRANSFORM_NON_LAST (0x3)
output: | last substructure: saving location 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform'
output: | emitting length of IKEv2 Transform Substructure Payload: 8
output: | emitting length of IKEv2 Proposal Substructure Payload: 56
output: | last substructure: checking 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform' is 0
output: | discard DH=NONE when counting transforms (multiple 0; allow single 0)
output: | *****emit IKEv2 Proposal Substructure Payload:
output: |    last proposal: v2_PROPOSAL_LAST (0x0)
output: |    prop #: 5 (05)
output: |    proto ID: IKEv2_SEC_PROTO_ESP (0x3)
output: |    spi size: 4 (04)
output: |    # transforms: 5 (05)
output: | last substructure: checking 'IKEv2 Security Association Payload'.'IKEv2 Proposal Substructure Payload'.'last proposal' containing v2_PROPOSAL_NON_LAST (0x2) is v2_PROPOSAL_NON_LAST (0x2)
output: | last substructure: saving location 'IKEv2 Security Association Payload'.'IKEv2 Proposal Substructure Payload'.'last proposal'
output: | emitting 4 raw bytes of our spi into IKEv2 Proposal Substructure Payload
output: | our spi: 2b a3 65 75
output: | ******emit IKEv2 Transform Substructure Payload:
output: |    last transform: v2_TRANSFORM_NON_LAST (0x3)
output: |    IKEv2 transform type: IKEv2_TRANS_TYPE_ENCR (0x1)
output: |    IKEv2 transform ID: AES_CBC (0xc)
output: | last substructure: saving location 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform'
output: | *******emit IKEv2 Attribute Substructure Payload:
output: |    af+type: AF+IKEv2_KEY_LENGTH (0x800e)
output: |    length/value: 128 (00 80)
output: | emitting length of IKEv2 Transform Substructure Payload: 12
output: | ******emit IKEv2 Transform Substructure Payload:
output: |    last transform: v2_TRANSFORM_NON_LAST (0x3)
output: |    IKEv2 transform type: IKEv2_TRANS_TYPE_INTEG (0x3)
output: |    IKEv2 transform ID: AUTH_HMAC_SHA2_512_256 (0xe)
output: | last substructure: checking 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform' containing v2_TRANSFORM_NON_LAST (0x3) is v2_TRANSFORM_NON_LAST (0x3)
output: | last substructure: saving location 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform'
output: | emitting length of IKEv2 Transform Substructure Payload: 8
output: | ******emit IKEv2 Transform Substructure Payload:
output: |    last transform: v2_TRANSFORM_NON_LAST (0x3)
output: |    IKEv2 transform type: IKEv2_TRANS_TYPE_INTEG (0x3)
output: |    IKEv2 transform ID: AUTH_HMAC_SHA2_256_128 (0xc)
output: | last substructure: checking 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform' containing v2_TRANSFORM_NON_LAST (0x3) is v2_TRANSFORM_NON_LAST (0x3)
output: | last substructure: saving location 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform'
output: | emitting length of IKEv2 Transform Substructure Payload: 8
output: | discard DH=NONE when emitting proposal (multiple 0; allow single 0)
output: | ******emit IKEv2 Transform Substructure Payload:
output: |    last transform: v2_TRANSFORM_NON_LAST (0x3)
output: |    IKEv2 transform type: IKEv2_TRANS_TYPE_ESN (0x5)
output: |    IKEv2 transform ID: IKEv2_ESN_YES (0x1)
output: | last substructure: checking 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform' containing v2_TRANSFORM_NON_LAST (0x3) is v2_TRANSFORM_NON_LAST (0x3)
output: | last substructure: saving location 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform'
output: | emitting length of IKEv2 Transform Substructure Payload: 8
output: | ******emit IKEv2 Transform Substructure Payload:
output: |    last transform: v2_TRANSFORM_LAST (0x0)
output: |    IKEv2 transform type: IKEv2_TRANS_TYPE_ESN (0x5)
output: |    IKEv2 transform ID: IKEv2_ESN_NO (0x0)
output: | last substructure: checking 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform' containing v2_TRANSFORM_NON_LAST (0x3) is v2_TRANSFORM_NON_LAST (0x3)
output: | last substructure: saving location 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform'
output: | emitting length of IKEv2 Transform Substructure Payload: 8
output: | emitting length of IKEv2 Proposal Substructure Payload: 56
output: | last substructure: checking 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform' is 0
output: | emitting length of IKEv2 Security Association Payload: 232
output: | last substructure: checking 'IKEv2 Security Association Payload'.'IKEv2 Proposal Substructure Payload'.'last proposal' is 0
output: | CP: send-v2CP=no; left: local; right: remote;
output: | ****emit IKEv2 Traffic Selector - Initiator - Payload:
output: |    next payload type: ISAKMP_NEXT_v2NONE (0x0)
output: |    flags: none (0x0)
output: |    number of TS: 1 (01)
output: | next payload chain: setting previous 'IKEv2 Security Association Payload'.'next payload type' to current IKEv2 Traffic Selector - Initiator - Payload (44:ISAKMP_NEXT_v2TSi)
output: | next payload chain: saving location 'IKEv2 Traffic Selector - Initiator - Payload'.'next payload type' in 'IKE_AUTH request'
output: | *****emit IKEv2 Traffic Selector Header:
output: |    TS type: IKEv2_TS_IPV4_ADDR_RANGE (0x7)
output: |    IP Protocol ID: ALL (0x0)
output: | ******emit IKEv2 IP Traffic Selector port range:
output: |    start port: 0 (00 00)
output: |    end port: 65535 (ff ff)
output: | emitting 4 raw bytes of IP start into IKEv2 Traffic Selector Header
output: | IP start: c0 00 01 00
output: | emitting 4 raw bytes of IP end into IKEv2 Traffic Selector Header
output: | IP end: c0 00 01 ff
output: | emitting length of IKEv2 Traffic Selector Header: 16
output: | emitting length of IKEv2 Traffic Selector - Initiator - Payload: 24
output: | ****emit IKEv2 Traffic Selector - Responder - Payload:
output: |    next payload type: ISAKMP_NEXT_v2NONE (0x0)
output: |    flags: none (0x0)
output: |    number of TS: 1 (01)
output: | next payload chain: setting previous 'IKEv2 Traffic Selector - Initiator - Payload'.'next payload type' to current IKEv2 Traffic Selector - Responder - Payload (45:ISAKMP_NEXT_v2TSr)
output: | next payload chain: saving location 'IKEv2 Traffic Selector - Responder - Payload'.'next payload type' in 'IKE_AUTH request'
output: | *****emit IKEv2 Traffic Selector Header:
output: |    TS type: IKEv2_TS_IPV4_ADDR_RANGE (0x7)
output: |    IP Protocol ID: ALL (0x0)
output: | ******emit IKEv2 IP Traffic Selector port range:
output: |    start port: 0 (00 00)
output: |    end port: 65535 (ff ff)
output: | emitting 4 raw bytes of IP start into IKEv2 Traffic Selector Header
output: | IP start: c0 00 02 00
output: | emitting 4 raw bytes of IP end into IKEv2 Traffic Selector Header
output: | IP end: c0 00 02 ff
output: | emitting length of IKEv2 Traffic Selector Header: 16
output: | emitting length of IKEv2 Traffic Selector - Responder - Payload: 24
output: | Initiator child policy is transport mode, sending v2N_USE_TRANSPORT_MODE? no
output: | adding 1 bytes of padding (including 1 byte padding-length)
output: | emitting 0 as 1 bytes of padding and length into IKEv2 Encryption Payload
output: | emitting 16 zero bytes of length of truncated HMAC/KEY into IKEv2 Encryption Payload
output: | emitting length of IKEv2 Encryption Payload: 405
output: | emitting length of ISAKMP Message: 433
output: | recording outgoing fragment failed
output: | job 4 helper 1 #3 process_v2_IKE_SA_INIT_response (dh): final status STF_OK; cleaning up
output: | delref @0x7f37fdf2bfd8(2->1) (cleanup_dh_shared_secret() +170 programs/pluto/crypt_dh.c)
output: | DH: delref secret-key@NULL
output: | "west-east" #3: releasing whack (but there are none) (free_job() +430 programs/pluto/server_pool.c)
output: | logger: delref @0x7f37fdf09fc8(1->0) (free_job() +430 programs/pluto/server_pool.c)
output: | job: delref @0x7f37fdf05f98(1->0) (free_job() +431 programs/pluto/server_pool.c)
output: | #3 complete_v2_state_transition() PARENT_I1->PARENT_I2 with status STF_OK
output: | transitioning from state STATE_V2_PARENT_I1 to state STATE_V2_PARENT_I2
output: | Message ID: updating counters for #3
output: | Message ID: IKE #3 clearing EVENT_RETRANSMIT as response received (initiator: .sent=0 .recv=-1 .recv_frags=0 .wip=-1 .last_sent=13.075329 .last_recv=13.008639 responder: .sent=-1 .recv=-1 .recv_frags=0 .wip=-1 .last_sent=13.008639 .last_recv=13.008639)
output: | #3 requesting EVENT_RETRANSMIT-event@0x7f37feaa7fa8 be deleted (clear_retransmits() +108 programs/pluto/retransmit.c)
output: | #3 deleting EVENT_RETRANSMIT
output: | tt: delref @0x7f37fdf36f68(1->0) (destroy_timeout() +575 programs/pluto/server.c)
output: | state-event: delref @0x7f37feaa7fa8(1->0) (clear_retransmits() +108 programs/pluto/retransmit.c)
output: | #3 STATE_V2_PARENT_I1: retransmits: cleared
output: | Message ID: IKE #3 updating initiator received message response 0 (initiator: .recv=-1->0 .wip=0->-1 .last_recv=13.008639->13.235354 responder:)
output: | Message ID: IKE #3 scheduling EVENT_RETRANSMIT (initiator: .sent=0 .recv=0 .recv_frags=0 .wip=1 .last_sent=13.075329 .last_recv=13.235354 responder: .sent=-1 .recv=-1 .recv_frags=0 .wip=-1 .last_sent=13.008639 .last_recv=13.008639)
output: | event_schedule_where: newref EVENT_RETRANSMIT-pe@0x7f37feaa7fa8 timeout in 60 seconds for #3
output: | tt: newref @0x7f37fdf36f68(0->1) (schedule_timeout() +557 programs/pluto/server.c)
output: | #3 STATE_V2_PARENT_I1: retransmits: first event in 60 seconds; timeout in 60 seconds; limit of 12 retransmits; current time is 13.235583
output: | Message ID: IKE #3 updating initiator sent message request 1 (initiator: .sent=0->1 .wip=-1->1 .last_sent=13.075329->13.23584 responder:)
output: | parent state #3: PARENT_I1(half-open IKE SA) => PARENT_I2(open IKE SA)
output: | Message ID: IKE #3 no pending message initiators to schedule (initiator: .sent=1 .recv=0 .recv_frags=0 .wip=1 .last_sent=13.23584 .last_recv=13.235354 responder: .sent=-1 .recv=-1 .recv_frags=0 .wip=-1 .last_sent=13.008639 .last_recv=13.008639)
output: | checking that a retransmit timeout_event was already
output: | #3 deleting EVENT_CRYPTO_TIMEOUT
output: | tt: delref @0x7f37fdf0df68(1->0) (destroy_timeout() +575 programs/pluto/server.c)
output: | state-event: delref @0x7f37fdf0bfa8(1->0) (delete_event() +534 programs/pluto/timer.c)
output: | sending 433 bytes for Initiator: process IKE_SA_INIT reply, initiate IKE_AUTH or IKE_INTERMEDIATE through eth1 from 192.1.2.45:500 to 192.1.2.23:500 using UDP (for #3)
output: |   aa 3a c6 a2  e1 65 10 22  9f f8 fa 9e  d9 73 44 e5   .:...e.".....sD.
output: |   2e 20 23 08  00 00 00 01  00 00 01 b1  23 00 01 95   . #.........#...
output: |   23 95 df d0  d7 c2 99 97  66 ae 5f 48  b5 f1 6b 3e   #.......f._H..k>
output: |   b8 45 61 5f  34 6f d1 22  c5 5a a9 2d  0e f0 f0 c9   .Ea_4o.".Z.-....
output: |   87 71 cc 4a  f5 e3 59 a7  1e ac 65 fc  d2 2f e4 74   .q.J..Y...e../.t
output: |   d3 ae c6 a5  08 8d 83 07  00 07 c0 82  18 18 40 12   ..............@.
output: |   71 dd a9 04  04 11 11 6e  23 98 b0 0a  00 d4 b3 c7   q......n#.......
output: |   d1 9d 40 4e  83 00 a4 82  4d fa 3b aa  b5 1a 19 9b   ..@N....M.;.....
output: |   e9 91 83 36  1b 53 6d e5  02 d1 a1 1d  0f 81 ad 77   ...6.Sm........w
output: |   29 11 3c ca  be 5a 7c 1a  f0 45 c8 5f  5a 21 70 0a   ).<..Z|..E._Z!p.
output: |   51 1e 5a 79  0a 29 54 20  9b 16 57 4b  31 41 00 e6   Q.Zy.)T ..WK1A..
output: |   6e 02 20 03  ba 6c bf 79  a3 bc 62 a6  56 50 37 b8   n. ..l.y..b.VP7.
output: |   2c ce 90 71  4f 75 43 51  07 7d 25 2d  96 eb e5 fc   ,..qOuCQ.}%-....
output: |   aa 90 00 10  ff 94 e5 d0  f5 52 c7 0e  23 c6 b9 00   .........R..#...
output: |   28 4c ae 86  21 a1 2a 17  eb 5f 6e 03  84 6b 5a 68   (L..!.*.._n..kZh
output: |   4c 21 b4 d8  0a d0 f1 77  8e 4d b5 9c  67 63 d1 55   L!.....w.M..gc.U
output: |   7d b1 66 2a  fa 01 f3 50  1b d6 db de  4d 19 7c 2d   }.f*...P....M.|-
output: |   79 ac ba 8a  ef 7f 76 f0  f5 00 95 77  72 03 fe 39   y.....v....wr..9
output: |   6d 44 44 44  74 7d f1 e2  0d 7e 53 40  b5 27 3c 8c   mDDDt}...~S@.'<.
output: |   f1 d8 cd 4f  24 50 c9 55  be 2f 5a c5  c6 7e 3e 97   ...O$P.U./Z..~>.
output: |   f6 83 ee a2  18 01 f3 f9  40 eb 48 ce  7d 43 d6 72   ........@.H.}C.r
output: |   5b a8 7c 72  02 36 34 e4  fc 4d 26 41  19 d8 df f9   [.|r.64..M&A....
output: |   6e 9f a3 b1  47 14 8a e8  be 14 84 b1  c3 1e e0 d0   n...G...........
output: |   44 50 d6 31  93 3f 96 9f  e1 70 1a a8  8a ac 97 03   DP.1.?...p......
output: |   25 94 70 f7  c0 84 e4 f5  f1 dd e1 46  83 3a 73 8d   %.p........F.:s.
output: |   54 f2 d8 34  01 d5 04 ed  4d 09 6d 67  2d fa dc 53   T..4....M.mg-..S
output: |   10 e0 a2 24  58 28 b6 52  0e d8 84 37  2a 20 32 d7   ...$X(.R...7* 2.
output: |   3a                                                   :
output: | sent 1 messages
output: "west-east" #3: sent IKE_AUTH request to 192.1.2.23:UDP/500
output: | packet from 192.1.2.23:500: delref @0x7f37fe0f36f8(1->0) (resume_handler() +687 programs/pluto/server.c)
output: | packet from 192.1.2.23:500: releasing whack (but there are none) (resume_handler() +687 programs/pluto/server.c)
output: | logger: delref @0x7f37fdf74fc8(1->0) (resume_handler() +687 programs/pluto/server.c)
output: | delref @0x7f37feaabf38(4->3) (resume_handler() +687 programs/pluto/server.c)
output: | #3 spent 7.78 (47.8) milliseconds in resume sending job back to main thread
output: | tt: delref @0x7f37fdf11f68(1->0) (destroy_timeout() +575 programs/pluto/server.c)
output: | spent 0 (0.00103) milliseconds in udp_read_packet() calling check_incoming_msg_errqueue()
output: | struct msg_digest: newref @0x7f37fe0f3708(0->1) (udp_read_packet() +249 programs/pluto/iface_udp.c)
output: | struct iface_endpoint: addref @0x7f37feaabf38(3->4) (udp_read_packet() +249 programs/pluto/iface_udp.c)
output: | alloc logger: newref @0x7f37fdf74fc8(0->1) (udp_read_packet() +249 programs/pluto/iface_udp.c)
output: | *received 225 bytes from 192.1.2.23:500 on eth1 192.1.2.45:500 using UDP
output: |   aa 3a c6 a2  e1 65 10 22  9f f8 fa 9e  d9 73 44 e5   .:...e.".....sD.
output: |   2e 20 23 20  00 00 00 01  00 00 00 e1  24 00 00 c5   . # ........$...
output: |   7d 09 d9 48  46 27 46 8c  ba 65 6e c6  25 8f cf 12   }..HF'F..en.%...
output: |   0b 13 62 fb  bb ab 4e 04  3d b4 6f 65  96 08 11 ea   ..b...N.=.oe....
output: |   f4 b0 6d 79  42 d5 fe 28  13 49 7c 73  f1 4c fa a3   ..myB..(.I|s.L..
output: |   d9 a8 31 3c  40 e6 04 60  12 df 2e 0c  f2 95 66 ca   ..1<@..`......f.
output: |   4a c8 5e ee  ef f4 bf f8  cb c2 85 1d  a1 0b d7 ae   J.^.............
output: |   97 21 90 7a  6b 85 e8 e3  5b bb 41 d7  88 d8 e5 38   .!.zk...[.A....8
output: |   cc 0c de 79  4c ff cc 31  c1 fc 14 48  d9 be 34 c4   ...yL..1...H..4.
output: |   08 7f e3 33  d6 78 c1 b6  4b b0 3a 46  14 6f 68 24   ...3.x..K.:F.oh$
output: |   0e 53 4f 72  6c af 97 36  51 43 0e 62  02 54 d6 0f   .SOrl..6QC.b.T..
output: |   75 e2 35 93  aa ac 30 a0  ea 42 a2 7a  de 03 01 6d   u.5...0..B.z...m
output: |   2a 87 eb 00  3c f4 82 b3  e1 4f 63 b2  b8 13 e0 dd   *...<....Oc.....
output: |   65 0d bd 9c  14 7f 27 2e  d8 ab 54 06  2e 0d ae f6   e.....'...T.....
output: |   6c                                                   l
output: | **parse ISAKMP Message:
output: |    initiator SPI: aa 3a c6 a2  e1 65 10 22
output: |    responder SPI: 9f f8 fa 9e  d9 73 44 e5
output: |    next payload type: ISAKMP_NEXT_v2SK (0x2e)
output: |    ISAKMP version: IKEv2 version 2.0 (rfc4306/rfc5996) (0x20)
output: |    exchange type: ISAKMP_v2_IKE_AUTH (0x23)
output: |    flags: ISAKMP_FLAG_v2_MSG_RESPONSE (0x20)
output: |    Message ID: 1 (00 00 00 01)
output: |    length: 225 (00 00 00 e1)
output: |  processing version=2.0 packet with exchange type=ISAKMP_v2_IKE_AUTH (35)
output: | I am the IKE SA Original Initiator receiving an IKEv2 IKE_AUTH response 
output: | State DB: found IKEv2 state #3 in PARENT_I2 (find_v2_ike_sa)
output: | #3 is idle
output: | #3 idle
output: | unpacking clear payload
output: | Now let's proceed with payload (ISAKMP_NEXT_v2SK)
output: | ***parse IKEv2 Encryption Payload:
output: |    next payload type: ISAKMP_NEXT_v2IDr (0x24)
output: |    flags: none (0x0)
output: |    length: 197 (00 c5)
output: | processing payload: ISAKMP_NEXT_v2SK (len=193)
output: | looking for transition from PARENT_I2 matching IKE_AUTH response: SK (ignoring secured payloads)
output: |   trying: Initiator: process IKE_INTERMEDIATE reply, initiate IKE_AUTH or IKE_INTERMEDIATE
output: |     exchange type does not match IKE_INTERMEDIATE
output: |   trying: Initiator: process IKE_AUTH response
output: |     matching by ignoring secured payloads
output: | stripping 1 octets as pad
output: | #3 ikev2 ISAKMP_v2_IKE_AUTH decrypt success
output: | struct msg_digest: addref @0x7f37fe0f3708(1->2) (process_packet_with_secured_ike_sa() +2204 programs/pluto/ikev2.c)
output: | Now let's proceed with payload (ISAKMP_NEXT_v2IDr)
output: | **parse IKEv2 Identification - Responder - Payload:
output: |    next payload type: ISAKMP_NEXT_v2AUTH (0x27)
output: |    flags: none (0x0)
output: |    length: 12 (00 0c)
output: |    ID type: ID_FQDN (0x2)
output: |    reserved: 00 00 00
output: | processing payload: ISAKMP_NEXT_v2IDr (len=4)
output: | Now let's proceed with payload (ISAKMP_NEXT_v2AUTH)
output: | **parse IKEv2 Authentication Payload:
output: |    next payload type: ISAKMP_NEXT_v2SA (0x21)
output: |    flags: none (0x0)
output: |    length: 72 (00 48)
output: |    auth method: IKEv2_AUTH_SHARED (0x2)
output: | processing payload: ISAKMP_NEXT_v2AUTH (len=64)
output: | Now let's proceed with payload (ISAKMP_NEXT_v2SA)
output: | **parse IKEv2 Security Association Payload:
output: |    next payload type: ISAKMP_NEXT_v2TSi (0x2c)
output: |    flags: none (0x0)
output: |    length: 36 (00 24)
output: | processing payload: ISAKMP_NEXT_v2SA (len=32)
output: | Now let's proceed with payload (ISAKMP_NEXT_v2TSi)
output: | **parse IKEv2 Traffic Selector - Initiator - Payload:
output: |    next payload type: ISAKMP_NEXT_v2TSr (0x2d)
output: |    flags: none (0x0)
output: |    length: 24 (00 18)
output: |    number of TS: 1 (01)
output: | processing payload: ISAKMP_NEXT_v2TSi (len=16)
output: | Now let's proceed with payload (ISAKMP_NEXT_v2TSr)
output: | **parse IKEv2 Traffic Selector - Responder - Payload:
output: |    next payload type: ISAKMP_NEXT_v2NONE (0x0)
output: |    flags: none (0x0)
output: |    length: 24 (00 18)
output: |    number of TS: 1 (01)
output: | processing payload: ISAKMP_NEXT_v2TSr (len=16)
output: | looking for transition from PARENT_I2 matching IKE_AUTH response: SK{IDr,AUTH,SA,TSi,TSr}
output: |   trying: Initiator: process IKE_INTERMEDIATE reply, initiate IKE_AUTH or IKE_INTERMEDIATE
output: |     exchange type does not match IKE_INTERMEDIATE
output: |   trying: Initiator: process IKE_AUTH response
output: |     secured message matched
output: | selected state microcode Initiator: process IKE_AUTH response
output: | #3.st_v2_transition PARENT_I1->PARENT_I2 -> PARENT_I2->ESTABLISHED_IKE_SA (v2_dispatch() +2308 programs/pluto/ikev2.c)
output: | Message ID: IKE #3 initiator processing response to existing exchange (initiator: .sent=1 .recv=0 .recv_frags=0 .wip=1 .last_sent=13.23584 .last_recv=13.235354 responder: .sent=-1 .recv=-1 .recv_frags=0 .wip=-1 .last_sent=13.008639 .last_recv=13.008639)
output: | calling processor Initiator: process IKE_AUTH response
output: |   #3 spent 1.25 (10.1) milliseconds
output: | no certs to decode
output: | responder ID is ID_FQDN: '@east'
output: | rhc: peer ID matches and no certificate payload - continuing with peer ID @east
output: |     result: newref clone-key@0x7f37fe098f80 (64-bytes, SHA512_HMAC)(init_symkey() +101 lib/libswan/ike_alg_prf_mac_nss_ops.c)
output: | idhash auth R2: delref clone-key@0x7f37fe098f80
output: | initiator verifying AUTH payload
output: | verifying auth payload, remote sent v2AUTH=SHARED we want auth=secret
output: | ikev2_calculate_psk_sighash() called for STATE_V2_PARENT_I2 to REMOTE_PERSPECTIVE PSK with authby=secret
output: | lsw_get_secret() using IDs for @west->@east of kind SECRET_PSK
output: | line 1: key type SECRET_PSK(@west) to type SECRET_PSK
output: | 1: compared key @west to @west / @east -> 8
output: | 2: compared key @east to @west / @east -> c
output: |   match=c
output: |   match c beats previous best_match 0 match=0x7f37fe017f68 (line=1)
output: | concluding with best_match=c best=0x7f37fe017f68 (lineno=1)
output: |     result: newref pss-key@0x7f37fea00f80 (52-bytes, EXTRACT_KEY_FROM_KEY)(merge_symkey_bytes() +222 lib/libswan/crypt_symkey.c)
output: |     result: newref pss-key@0x7f37fe098f80 (36-bytes, SHA512_HMAC)(psk_auth() +201 lib/libswan/ike_alg_prf_ikev2_nss_ops.c)
output: | pss: delref tmp-key@0x7f37fea00f80
output: |     result: newref prf(Shared Secret, "Key Pad for IKEv2")-key@0x7f37fea00f80 (64-bytes, SHA512_HMAC)(psk_auth() +228 lib/libswan/ike_alg_prf_ikev2_nss_ops.c)
output: | psk pss_key: delref pss_key-key@0x7f37fe098f80
output: |     result: newref clone-key@0x7f37fe098f80 (64-bytes, SHA512_HMAC)(init_symkey() +101 lib/libswan/ike_alg_prf_mac_nss_ops.c)
output: | <signed-octets> = prf(<prf-psk>, <msg octets>): delref clone-key@0x7f37fe098f80
output: | psk_auth: delref prf-psk-key@0x7f37fea00f80
output: "west-east" #3: initiator established IKE SA; authenticated peer using authby=secret and ID_FQDN '@east'
output: | parent state #3: PARENT_I2(open IKE SA) => ESTABLISHED_IKE_SA(established IKE SA)
output: | "west-east": addref @0x7f37fea9da78(4->5) "west-east" #3:  (dispatch() +2436 programs/pluto/routing.c)
output: | "west-east" #3: routing: start ESTABLISH_IKE, ROUTED_NEGOTIATION, PERMANENT; IKE #3 (ESTABLISHED_IKE_SA) by=PEER; $1@0x7f37fea9da78; routing_sa #4 negotiating_ike_sa #3 negotiating_child_sa #4 (v2_ike_sa_established() +193 programs/pluto/ikev2_parent.c)
output: | "west-east" #3: routing: stop ESTABLISH_IKE, ROUTED_NEGOTIATION, PERMANENT; ok=yes; routing_sa #4 negotiating_ike_sa #3 established_ike_sa #0->#3 negotiating_child_sa #4 (v2_ike_sa_established() +193 programs/pluto/ikev2_parent.c)
output: | "west-east": delref @0x7f37fea9da78(5->4) "west-east" #3:  (dispatch() +2450 programs/pluto/routing.c)
output: | pstats #3 ikev2.ike established
output: | redirect: no redirect payload in IKE_AUTH reply
output: | MOBIKE_SUPPORTED neither requested nor accepted
output: | comparing remote proposals against IKE_AUTH initiator accepting remote ESP/AH proposal 5 local proposals
output: | local proposal 1 type ENCR has 1 transforms
output: | local proposal 1 type PRF has 0 transforms
output: | local proposal 1 type INTEG has 1 transforms
output: | local proposal 1 type DH has 1 transforms
output: | local proposal 1 type ESN has 2 transforms
output: | local proposal 1 transforms: required: ENCR+ESN; optional: INTEG+DH
output: | local proposal 2 type ENCR has 1 transforms
output: | local proposal 2 type PRF has 0 transforms
output: | local proposal 2 type INTEG has 1 transforms
output: | local proposal 2 type DH has 1 transforms
output: | local proposal 2 type ESN has 2 transforms
output: | local proposal 2 transforms: required: ENCR+ESN; optional: INTEG+DH
output: | local proposal 3 type ENCR has 1 transforms
output: | local proposal 3 type PRF has 0 transforms
output: | local proposal 3 type INTEG has 1 transforms
output: | local proposal 3 type DH has 1 transforms
output: | local proposal 3 type ESN has 2 transforms
output: | local proposal 3 transforms: required: ENCR+ESN; optional: INTEG+DH
output: | local proposal 4 type ENCR has 1 transforms
output: | local proposal 4 type PRF has 0 transforms
output: | local proposal 4 type INTEG has 2 transforms
output: | local proposal 4 type DH has 1 transforms
output: | local proposal 4 type ESN has 2 transforms
output: | local proposal 4 transforms: required: ENCR+INTEG+ESN; optional: DH
output: | local proposal 5 type ENCR has 1 transforms
output: | local proposal 5 type PRF has 0 transforms
output: | local proposal 5 type INTEG has 2 transforms
output: | local proposal 5 type DH has 1 transforms
output: | local proposal 5 type ESN has 2 transforms
output: | local proposal 5 transforms: required: ENCR+INTEG+ESN; optional: DH
output: | ***parse IKEv2 Proposal Substructure Payload:
output: |    last proposal: v2_PROPOSAL_LAST (0x0)
output: |    length: 32 (00 20)
output: |    prop #: 1 (01)
output: |    proto ID: IKEv2_SEC_PROTO_ESP (0x3)
output: |    spi size: 4 (04)
output: |    # transforms: 2 (02)
output: | parsing 4 raw bytes of IKEv2 Proposal Substructure Payload into remote SPI
output: |   e7 fc 7f 3c                                          ...<
output: | Comparing remote proposal 1 containing 2 transforms against local proposal [1..1] of 5 local proposals
output: | ****parse IKEv2 Transform Substructure Payload:
output: |    last transform: v2_TRANSFORM_NON_LAST (0x3)
output: |    length: 12 (00 0c)
output: |    IKEv2 transform type: IKEv2_TRANS_TYPE_ENCR (0x1)
output: |    IKEv2 transform ID: AES_GCM_C (0x14)
output: | *****parse IKEv2 Attribute Substructure Payload:
output: |    af+type: AF+IKEv2_KEY_LENGTH (0x800e)
output: |    length/value: 256 (01 00)
output: | remote proposal 1 transform 0 (ENCR=AES_GCM_C_256) matches local proposal 1 type 1 (ENCR) transform 0
output: | ****parse IKEv2 Transform Substructure Payload:
output: |    last transform: v2_TRANSFORM_LAST (0x0)
output: |    length: 8 (00 08)
output: |    IKEv2 transform type: IKEv2_TRANS_TYPE_ESN (0x5)
output: |    IKEv2 transform ID: IKEv2_ESN_YES (0x1)
output: | remote proposal 1 transform 1 (ESN=YES) matches local proposal 1 type 5 (ESN) transform 0
output: | remote proposal 1 proposed transforms: ENCR+ESN; matched: ENCR+ESN; unmatched: none
output: | comparing remote proposal 1 containing ENCR+ESN transforms to local proposal 1; required: ENCR+ESN; optional: INTEG+DH; matched: ENCR+ESN
output: | remote proposal 1 matches local proposal 1
output: | remote accepted the proposal 1:ESP:ENCR=AES_GCM_C_256;ESN=YES[first-match]
output: | IKE_AUTH initiator accepting remote ESP/AH proposal ikev2_proposal: 1:ESP=AES_GCM_C_256-ESN:YES SPI=e7fc7f3c
output: | converting proposal to internal trans attrs
output: | TSi: parsing 1 traffic selectors
output: | ***parse IKEv2 Traffic Selector Header:
output: |    TS type: IKEv2_TS_IPV4_ADDR_RANGE (0x7)
output: |    IP Protocol ID: ALL (0x0)
output: |    length: 16 (00 10)
output: | ****parse IKEv2 IP Traffic Selector port range:
output: |    start port: 0 (00 00)
output: |    end port: 65535 (ff ff)
output: | parsing 4 raw bytes of IKEv2 Traffic Selector Header into TS IP start
output: |   c0 00 01 00                                          ....
output: | parsing 4 raw bytes of IKEv2 Traffic Selector Header into TS IP end
output: |   c0 00 01 ff                                          ....
output: | TSi: parsed 1 traffic selectors
output: | TSr: parsing 1 traffic selectors
output: | ***parse IKEv2 Traffic Selector Header:
output: |    TS type: IKEv2_TS_IPV4_ADDR_RANGE (0x7)
output: |    IP Protocol ID: ALL (0x0)
output: |    length: 16 (00 10)
output: | ****parse IKEv2 IP Traffic Selector port range:
output: |    start port: 0 (00 00)
output: |    end port: 65535 (ff ff)
output: | parsing 4 raw bytes of IKEv2 Traffic Selector Header into TS IP start
output: |   c0 00 02 00                                          ....
output: | parsing 4 raw bytes of IKEv2 Traffic Selector Header into TS IP end
output: |   c0 00 02 ff                                          ....
output: | TSr: parsed 1 traffic selectors
output: | ts: evaluating END EQUALS:
output: | ts:   narrow port: selector.port=0..65535 EQUALS TSi[1]=0..65535 ==> 0..65535(0) (must match)
output: | ts:   narrow protocol: selector.ipproto=*0 EQUALS TSi[1]=*0 ==> ALL (must match)
output: | ts:   narrow range: selector.range=192.0.1.0-192.0.1.255 EQUALS TSi[1]=192.0.1.0-192.0.1.255 ==> 192.0.1.0-192.0.1.255 (must match)
output: | ts:     narrowed TSi[1] address-range 192.0.1.0-192.0.1.255 has fitness 25
output: | ts:     narrowed TSi[1] port 0 has fitness 65536
output: | ts:     narrowed TSi[1] protocol ALL has fitness 255
output: | ts:   narrow port: selector.port=0..65535 EQUALS TSr[1]=0..65535 ==> 0..65535(0) (must match)
output: | ts:   narrow protocol: selector.ipproto=*0 EQUALS TSr[1]=*0 ==> ALL (must match)
output: | ts:   narrow range: selector.range=192.0.2.0-192.0.2.255 EQUALS TSr[1]=192.0.2.0-192.0.2.255 ==> 192.0.2.0-192.0.2.255 (must match)
output: | ts:     narrowed TSr[1] address-range 192.0.2.0-192.0.2.255 has fitness 25
output: | ts:     narrowed TSr[1] port 0 has fitness 65536
output: | ts:     narrowed TSr[1] protocol ALL has fitness 255
output: | skipping scribble as already scribbled
output: | skipping scribble as already scribbled
output: | accepted selectors [192.0.1.0/24]->[192.0.2.0/24]
output: | allocating 1 SPDs
output: | left.child.has_client: yes -> yes (scribble_ts_response_on_initiator() +285 programs/pluto/ikev2_ts.c)
output: | right.child.has_client: yes -> yes (scribble_ts_response_on_initiator() +287 programs/pluto/ikev2_ts.c)
output: | USE_TRANSPORT_MODE neither requested nor accepted
output: | local policy is Tunnel Mode and received matching notify
output: | integ=NONE: .key_size=0 encrypt=AES_GCM_16: .key_size=32 .salt_size=4 keymat_len=36
output: |     result: newref keymat-key@0x7f37fea00f80 (72-bytes, EXTRACT_KEY_FROM_KEY)(prfplus_key_data() +61 lib/libswan/ike_alg_prf_ikev2_nss_ops.c)
output: |     result: newref initiator to responder key-key@0x7f37fe098f80 (36-bytes, EXTRACT_KEY_FROM_KEY)(ikev2_derive_child_keys() +126 programs/pluto/ikev2_crypto.c)
output: | initiator to responder keys: newref slot-key@0x7f37feb06f80 (36-bytes, EXTRACT_KEY_FROM_KEY)
output: | initiator to responder keys: delref slot-key-key@0x7f37feb06f80
output: | ikev2_derive_child_keys: delref ikey-key@0x7f37fe098f80
output: |     result: newref responder to initiator key-key@0x7f37fe098f80 (36-bytes, EXTRACT_KEY_FROM_KEY)(ikev2_derive_child_keys() +133 programs/pluto/ikev2_crypto.c)
output: | responder to initiator keys:: newref slot-key@0x7f37feb06f80 (36-bytes, EXTRACT_KEY_FROM_KEY)
output: | responder to initiator keys:: delref slot-key-key@0x7f37feb06f80
output: | ikev2_derive_child_keys: delref rkey-key@0x7f37fe098f80
output: | ikev2_derive_child_keys: delref keymat-key@0x7f37fea00f80
output: | "west-east": addref @0x7f37fea9da78(4->5) "west-east" #4:  (dispatch() +2436 programs/pluto/routing.c)
output: | "west-east" #4: routing: start ESTABLISH_INBOUND, ROUTED_NEGOTIATION, PERMANENT; IKE #3 (ESTABLISHED_IKE_SA) Child #4 (IKE_AUTH_CHILD_I0) by=PEER; $1@0x7f37fea9da78; routing_sa #4 negotiating_ike_sa #3 established_ike_sa #3 negotiating_child_sa #4 (process_v2_child_response_payloads() +838 programs/pluto/ikev2_child.c)
output: | kernel: install_inbound_ipsec_sa() for #4: inbound (process_v2_child_response_payloads() +838 programs/pluto/ikev2_child.c)
output: | checking west-east for conflicts
output: | spd_owner() looking for SPD owner of 192.0.1.0/24===192.0.2.0/24 with routing >= ROUTED_INBOUND_NEGOTIATION[NEGOTIATION]
output: | FOR_EACH_SPD_ROUTE[remote_client_range=192.0.2.0/24]... in (install_inbound_ipsec_sa() +1986 programs/pluto/kernel.c)
output: |   found "west-east" 192.0.1.0/24===192.0.2.0/24
output: |    "west-east" 192.0.1.0/24===192.0.2.0/24 ROUTED_NEGOTIATION[NEGOTIATION] skipped; ignoring self
output: |   matches: 1
output: | spd_owner: owners of 192.0.1.0/24===192.0.2.0/24 routing >= ROUTED_INBOUND_NEGOTIATION[NEGOTIATION]
output: | initiator ipsec-max-bytes: hard-limit=9223372036854775808 soft-limit=4611686018427387900 softer-limit=2305843009213693950 fuzz=107395308575753345 actual-limit=2413238317789447295
output: | initiator ipsec-max-packets: hard-limit=9223372036854775808 soft-limit=4611686018427387900 softer-limit=2305843009213693950 fuzz=223890315155003941 actual-limit=2529733324368697891
output: | kernel: setup_half_kernel_state() INBOUND <unset-selector>->[192.1.2.23=TUNNEL=>192.1.2.45]-><unset-selector> sec_label=
output: | kernel: looking for alg with encrypt: AES_GCM_16 keylen: 256 integ: NONE
output: | encrypt AES_GCM_16 keylen=256 transid=20, key_size=32, encryptalg=20
output: | kernel: AES_GCM_16 requires 4 salt bytes
output: | kernel: child->sa.st_esp.keymat_len=36 is encrypt_keymat_size=36 + integ_keymat_size=0
output: | kernel: setting IPsec SA replay-window to 128
output: | kernel: Enabling ESN
output: | kernel: NIC esp-hw-offload disabled for connection 'west-east'
output: | "west-east" #4: routing:  kernel_ops_add_sa() level=0 INBOUND TUNNEL
output: | "west-east" #4: routing:   (src) <unset-selector> -> 192.1.2.23[2ba36575] ==> 192.1.2.45 -> <unset-selector> (dst)
output: | "west-east" #4: routing:   NONE:0 AES_GCM_16:36 replay_window=128 +esn +dont_encap_dscp ...
output: | netlink_add_sa() tunnel enabling inner-most tunnel mode
output: | netlink_add_sa() adding IPsec SA with reqid 16389
output: | netlink_add_sa() enabling ESN
output: | netlink_add_sa() disabling Encap DSCP
output: | netlink_add_sa() setting IPsec SA replay-window to 128 using xfrm_replay_state_esn
output: | netlink_add_sa() esp-hw-offload not set for IPsec SA
output: | sendrecv_xfrm_msg() sending 26 Add SA esp.ESPSPIi@192.1.2.45
output: | sendrecv_xfrm_msg() recvfrom() returned 36 bytes
output: | sendrecv_xfrm_msg() netlink response for Add SA esp.ESPSPIi@192.1.2.45 included non-error error
output: | "west-east" #4: routing:   ... yes
output: "west-east" #4: IMPAIR: kernel: install_ipsec_sa_inbound_state in setup_half_kernel_state()
output: | setup_half_kernel_state() cleaning up after a fail
output: | "west-east" #4: routing:  kernel_ops_del_ipsec_spi() deleting sa 192.1.2.23-ESP[2ba36575]->192.1.2.45 for esp.ESPSPIi@192.1.2.45 ...
output: | sendrecv_xfrm_msg() sending 17 Del SA esp.ESPSPIi@192.1.2.45
output: | sendrecv_xfrm_msg() recvfrom() returned 36 bytes
output: | sendrecv_xfrm_msg() netlink response for Del SA esp.ESPSPIi@192.1.2.45 included non-error error
output: | "west-east" #4: routing:   ... yes
output: | kernel: install_inbound_ipsec_sa() failed to install inbound kernel state
output: | "west-east" #4: routing: stop ESTABLISH_INBOUND, ROUTED_NEGOTIATION->ROUTED_INBOUND_NEGOTIATION, PERMANENT; ok=no; routing_sa #4 negotiating_ike_sa #3 established_ike_sa #3 negotiating_child_sa #4 (process_v2_child_response_payloads() +838 programs/pluto/ikev2_child.c)
output: | "west-east": delref @0x7f37fea9da78(5->4) "west-east" #4:  (dispatch() +2450 programs/pluto/routing.c)
output: "west-east" #4: CHILD SA encountered fatal error: INVALID_SYNTAX
output: | #3 complete_v2_state_transition() in state ESTABLISHED_IKE_SA PARENT_I2->ESTABLISHED_IKE_SA with status STF_FATAL
output: "west-east" #3: encountered fatal error in state STATE_V2_ESTABLISHED_IKE_SA
output: | Message ID: IKE #3 forcing a response received update (STF_FATAL) (initiator: .sent=1 .recv=0 .recv_frags=0 .wip=1 .last_sent=13.23584 .last_recv=13.235354 responder: .sent=-1 .recv=-1 .recv_frags=0 .wip=-1 .last_sent=13.008639 .last_recv=13.008639)
output: | Message ID: IKE #3 clearing EVENT_RETRANSMIT as response received (initiator: .sent=1 .recv=0 .recv_frags=0 .wip=-1 .last_sent=13.23584 .last_recv=13.235354 responder: .sent=-1 .recv=-1 .recv_frags=0 .wip=-1 .last_sent=13.008639 .last_recv=13.008639)
output: | #3 requesting EVENT_RETRANSMIT-event@0x7f37feaa7fa8 be deleted (clear_retransmits() +108 programs/pluto/retransmit.c)
output: | #3 deleting EVENT_RETRANSMIT
output: | tt: delref @0x7f37fdf36f68(1->0) (destroy_timeout() +575 programs/pluto/server.c)
output: | state-event: delref @0x7f37feaa7fa8(1->0) (clear_retransmits() +108 programs/pluto/retransmit.c)
output: | #3 STATE_V2_ESTABLISHED_IKE_SA: retransmits: cleared
output: | Message ID: IKE #3 updating initiator received message response 1 (initiator: .recv=0->1 .wip=1->-1 .last_recv=13.235354->13.370632 responder:)
output: | Message ID: IKE #3 skipping update_send as nothing to send (presumably intiator receiving a response) (initiator: .sent=1 .recv=1 .recv_frags=0 .wip=-1 .last_sent=13.23584 .last_recv=13.370632 responder: .sent=-1 .recv=-1 .recv_frags=0 .wip=-1 .last_sent=13.008639 .last_recv=13.008639)
output: | "west-east" #3: .st_on_delete.skip_send_delete no->true (complete_v2_state_transition() +2822 programs/pluto/ikev2.c)
output: | "west-east" #3: routing:   connection_zap_ike_family()
output: |   IKE SA is no longer viable
output: | "west-east" #3: routing:     dispatching delete to Child SA #4
output: | "west-east" #4: no whack to attach
output: | clone logger: newref @0x7f37fdf36fc8(0->1) (teardown_child() +1217 programs/pluto/routing.c)
output: | "west-east": addref @0x7f37fea9da78(4->5) "west-east" #4:  (dispatch() +2436 programs/pluto/routing.c)
output: | "west-east" #4: routing: start TEARDOWN_CHILD, ROUTED_INBOUND_NEGOTIATION, PERMANENT; Child #4 (IKE_AUTH_CHILD_I0) by=UNKNOWN; $1@0x7f37fea9da78; routing_sa #4 negotiating_ike_sa #3 established_ike_sa #3 negotiating_child_sa #4 (complete_v2_state_transition() +2823 programs/pluto/ikev2.c)
output: | "west-east" #4: routing:   Child SA matches .routing_sa
output: | revival: skip update_remote_port(), not an instance
output: "west-east" #4: connection is supposed to remain up; revival attempt 2 scheduled in 5 seconds
output: | string logger: newref @0x7f37fdf03fc8(0->1) (schedule_connection_event() +44 programs/pluto/connection_event.c)
output: | "west-east": addref @0x7f37fea9da78(5->6) event CONNECTION_REVIVAL for "west-east":  (schedule_connection_event() +49 programs/pluto/connection_event.c)
output: "west-east" #4: IMPAIR: revival: skip scheduling revival event
output: | spd_owner() looking for SPD owner of 192.0.1.0/24===192.0.2.0/24 with routing >= ROUTED_ONDEMAND[ONDEMAND]
output: | FOR_EACH_SPD_ROUTE[remote_client_range=192.0.2.0/24]... in (complete_v2_state_transition() +2823 programs/pluto/ikev2.c)
output: |   found "west-east" 192.0.1.0/24===192.0.2.0/24
output: |    "west-east" 192.0.1.0/24===192.0.2.0/24 ROUTED_INBOUND_NEGOTIATION[NEGOTIATION] skipped; ignoring self
output: |   matches: 1
output: | spd_owner: owners of 192.0.1.0/24===192.0.2.0/24 routing >= ROUTED_ONDEMAND[ONDEMAND]
output: | kernel: NIC esp-hw-offload disabled for connection 'west-east'
output: | priority calculation of is 1757393 (0x1ad0d1) base=1 portsw=2 protow=1, srcw=104 dstw=104 instw=1
output: | "west-east" #4: routing:  kernel_ops_policy_add() REPLACE+OUTBOUND replacing (complete_v2_state_transition() +2823 programs/pluto/ikev2.c)
output: | "west-east" #4: routing:   client=192.0.1.0/24=>192.0.2.0/24 lifetime=0s
output: | "west-east" #4: routing:   sa_marks=out:0/00000000,in:0/00000000
output: | "west-east" #4: routing:   policy=0.0.0.0=>0.0.0.0,ONDEMAND=TRAP,priority=1757393,TRANSPORT[ESP@0(ALL)]
output: | kernel_ops_policy_add()   policy=%trap(allow) action=0 xfrm_dir=1 op=REPLACE dir=OUTBOUND
output: | kernel_xfrm_policy_add() using family IPv4 (2)
output: | set_xfrm_selectors() using family IPv4 (2)
output: | kernel_xfrm_policy_add() IPsec SA SPD priority set to 1757393
output: | kernel_xfrm_policy_add() adding xfrm_user_tmpl reqid=0 id.proto=50 optional=0 family=2 mode=0 saddr=<unset-address> daddr=<unset-address>
output: | sendrecv_xfrm_msg() sending 25 policy %trap(allow)
output: | sendrecv_xfrm_msg() recvfrom() returned 36 bytes
output: | kernel_ops_policy_add()   XFRM_MSG_UPDPOLICY for flow %trap(allow) (out) had A policy
output: | "west-east" #4: routing:   ... yes
output: | "west-east" #4: routing:  kernel_ops_policy_del() INBOUND REPORT_NO_INBOUND inbound (complete_v2_state_transition() +2823 programs/pluto/ikev2.c)
output: | "west-east" #4: routing:   client=192.0.2.0/24=>192.0.1.0/24
output: | "west-east" #4: routing:   sa_marks=out:0/00000000,in:0/00000000
output: | kernel_xfrm_policy_del() using family IPv4 (2)
output: | set_xfrm_selectors() using family IPv4 (2)
output: | sendrecv_xfrm_msg() sending 20 policy delete
output: | sendrecv_xfrm_msg() recvfrom() returned 100 bytes
output: ERROR: "west-east" #4: kernel: xfrm XFRM_MSG_DELPOLICY delete response for flow (in): No such file or directory (errno 2)
output: | kernel_xfrm_policy_del() deleting policy forward (even when there may not be one)
output: | sendrecv_xfrm_msg() sending 20 policy delete
output: | sendrecv_xfrm_msg() recvfrom() returned 100 bytes
output: | kernel_ops_policy_del()   XFRM_MSG_DELPOLICY for flow delete (fwd) had NO policy
output: | "west-east" #4: routing:   ... no
output: "west-east" #4: kernel: replace_ipsec_with_bare_kernel_policy() inbound delete failed
output: | "west-east" #4: .st_on_delete.skip_send_delete no->true (delete_child_sa() +758 programs/pluto/state.c)
output: | "west-east" #4: delete_state() skipping log_message:no
output: | pstats #4 ikev2.child deleted other
output: | #4 main thread spent 0 (0) milliseconds helper thread spent 0 (0) milliseconds in total
output: | suspend: no MD saved in state #4 (delete_state() +973 programs/pluto/state.c)
output: | #4 STATE_V2_IKE_AUTH_CHILD_I0: retransmits: cleared
output: | kernel: uninstall_kernel_state() deleting OUTBOUND
output: | "west-east" #4: routing:  kernel_ops_del_ipsec_spi() deleting sa 192.1.2.45-ESP[e7fc7f3c]->192.1.2.23 for esp.ESPSPIi@192.1.2.23 ...
output: | sendrecv_xfrm_msg() sending 17 Del SA esp.ESPSPIi@192.1.2.23
output: | sendrecv_xfrm_msg() recvfrom() returned 60 bytes
output: ERROR: "west-east" #4: netlink response for Del SA esp.ESPSPIi@192.1.2.23: No such process (errno 3)
output: | "west-east" #4: routing:   ... no
output: | kernel: uninstall_kernel_state() deleting INBOUND
output: | "west-east" #4: routing:  kernel_ops_del_ipsec_spi() deleting sa 192.1.2.23-ESP[2ba36575]->192.1.2.45 for esp.ESPSPIi@192.1.2.45 ...
output: | sendrecv_xfrm_msg() sending 17 Del SA esp.ESPSPIi@192.1.2.45
output: | sendrecv_xfrm_msg() recvfrom() returned 60 bytes
output: ERROR: "west-east" #4: netlink response for Del SA esp.ESPSPIi@192.1.2.45: No such process (errno 3)
output: | "west-east" #4: routing:   ... no
output: | delref @0x7f37feaabf38(4->3) (delete_state() +1033 programs/pluto/state.c)
output: | "west-east": delref @0x7f37fea9da78(6->5)  #4:  (delete_state() +1073 programs/pluto/state.c)
output: | child state #4: IKE_AUTH_CHILD_I0(ignore) => UNDEFINED(ignore)
output: |  #4: releasing whack (but there are none) (delete_state() +1079 programs/pluto/state.c)
output: | delete_state: delref st->st_dh_shared_secret-key@NULL
output: | delete_state: delref st->st_skeyid_nss-key@NULL
output: | delete_state: delref st->st_skey_d_nss-key@0x7f37fe081f80
output: | delete_state: delref st->st_skey_ai_nss-key@NULL
output: | delete_state: delref st->st_skey_ar_nss-key@NULL
output: | delete_state: delref st->st_skey_ei_nss-key@0x7f37febc4f80
output: | delete_state: delref st->st_skey_er_nss-key@0x7f37fea15f80
output: | delete_state: delref st->st_skey_pi_nss-key@0x7f37febb5f80
output: | delete_state: delref st->st_skey_pr_nss-key@0x7f37feb0ef80
output: | delete_state: delref st->st_enc_key_nss-key@NULL
output: | delete_state: delref st->st_sk_d_no_ppk-key@NULL
output: | delete_state: delref st->st_sk_pi_no_ppk-key@NULL
output: | delete_state: delref st->st_sk_pr_no_ppk-key@NULL
output: |  #4: releasing whack (but there are none) (delete_state() +1172 programs/pluto/state.c)
output: | logger: delref @0x7f37fdf78fc8(1->0) (delete_state() +1172 programs/pluto/state.c)
output: | "west-east" #4: routing: stop TEARDOWN_CHILD, ROUTED_INBOUND_NEGOTIATION->ROUTED_ONDEMAND, PERMANENT; ok=yes; routing_sa #4->#0 negotiating_ike_sa #3 established_ike_sa #3 negotiating_child_sa #4->#0 revival 1->2 (complete_v2_state_transition() +2823 programs/pluto/ikev2.c)
output: | "west-east": delref @0x7f37fea9da78(5->4) "west-east" #4:  (dispatch() +2450 programs/pluto/routing.c)
output: | "west-east" #4: releasing whack (but there are none) (teardown_child() +1236 programs/pluto/routing.c)
output: | logger: delref @0x7f37fdf36fc8(1->0) (teardown_child() +1236 programs/pluto/routing.c)
output: | FOR_EACH_STATE[clonedfrom=#3]... in (connection_zap_ike_family() +568 programs/pluto/terminate.c)
output: |   matches: 0
output: | clone logger: newref @0x7f37fdf01fc8(0->1) (teardown_ike() +1278 programs/pluto/routing.c)
output: | "west-east": addref @0x7f37fea9da78(4->5) "west-east" #3:  (dispatch() +2436 programs/pluto/routing.c)
output: | "west-east" #3: routing: start TEARDOWN_IKE, ROUTED_ONDEMAND, PERMANENT; IKE #3 (ESTABLISHED_IKE_SA) by=UNKNOWN; $1@0x7f37fea9da78; negotiating_ike_sa #3 established_ike_sa #3 (complete_v2_state_transition() +2823 programs/pluto/ikev2.c)
output: | "west-east" #3: routing:   IKE SA does not match .routing_sa #0
output: | "west-east" #3: .st_on_delete.skip_send_delete yes->true (delete_ike_sa() +771 programs/pluto/state.c)
output: | "west-east" #3: delete_state() skipping log_message:no
output: | FOR_EACH_STATE[clonedfrom=#3]... in (delete_state() +873 programs/pluto/state.c)
output: |   matches: 0
output: "west-east" #3: deleting IKE SA (ESTABLISHED_IKE_SA) and NOT sending notification
output: | "west-east" #3: .st_on_delete.skip_log_message no->true (llog_sa_delete_n_send() +852 programs/pluto/state.c)
output: | pstats #3 ikev2.ike deleted completed
output: | #3 main thread spent 16 (136) milliseconds helper thread spent 4.78 (9.52) milliseconds in total
output: | suspend: no MD saved in state #3 (delete_state() +973 programs/pluto/state.c)
output: | #3 STATE_V2_ESTABLISHED_IKE_SA: retransmits: cleared
output: | pending: flush_pending_by_state() ike 0x7f37fe071348 pending 0x7f37fe083fa8
output: | pending: flush_pending_by_state() ike 0x7f37fe071348 pending 0x7f37fe083fa8 connection 0x7f37fea9da78 ike 0x7f37fe071348
output: | pending: flush pending [0x7f37fe083fa8] Child SA connection "west-east" [0x7f37fea9da78]
output: | "west-east": delref @0x7f37fea9da78(5->4)  (delete_pending() +262 programs/pluto/pending.c)
output: | "west-east": releasing whack (but there are none) (delete_pending() +263 programs/pluto/pending.c)
output: | logger: delref @0x7f37feaa5fc8(1->0) (delete_pending() +263 programs/pluto/pending.c)
output: | FOR_EACH_STATE[clonedfrom=#3]... in (flush_incomplete_children() +729 programs/pluto/state.c)
output: |   matches: 0
output: | "west-east" #3: disown .negotiating_ike_sa
output: | "west-east" #3: disown .established_ike_sa
output: | delref @0x7f37feaabf38(3->2) (delete_state() +1033 programs/pluto/state.c)
output: | "west-east": delref @0x7f37fea9da78(4->3)  #3:  (delete_state() +1073 programs/pluto/state.c)
output: | parent state #3: ESTABLISHED_IKE_SA(established IKE SA) => UNDEFINED(ignore)
output: |  #3: releasing whack (but there are none) (delete_state() +1079 programs/pluto/state.c)
output: | delref @0x7f37fdf2bfd8(1->0) (delete_state() +1094 programs/pluto/state.c)
output: | delete_state: delref st->st_dh_shared_secret-key@0x7f37feb0cf80
output: | delete_state: delref st->st_skeyid_nss-key@NULL
output: | delete_state: delref st->st_skey_d_nss-key@0x7f37fe081f80
output: | delete_state: delref st->st_skey_ai_nss-key@NULL
output: | delete_state: delref st->st_skey_ar_nss-key@NULL
output: | delete_state: delref st->st_skey_ei_nss-key@0x7f37febc4f80
output: | delete_state: delref st->st_skey_er_nss-key@0x7f37fea15f80
output: | delete_state: delref st->st_skey_pi_nss-key@0x7f37febb5f80
output: | delete_state: delref st->st_skey_pr_nss-key@0x7f37feb0ef80
output: | delete_state: delref st->st_enc_key_nss-key@NULL
output: | delete_state: delref st->st_sk_d_no_ppk-key@NULL
output: | delete_state: delref st->st_sk_pi_no_ppk-key@NULL
output: | delete_state: delref st->st_sk_pr_no_ppk-key@NULL
output: |  #3: releasing whack (but there are none) (delete_state() +1172 programs/pluto/state.c)
output: | logger: delref @0x7f37fdf2ffc8(1->0) (delete_state() +1172 programs/pluto/state.c)
output: | "west-east" #3: routing: stop TEARDOWN_IKE, ROUTED_ONDEMAND, PERMANENT; ok=yes; negotiating_ike_sa #3->#0 established_ike_sa #3->#0 (complete_v2_state_transition() +2823 programs/pluto/ikev2.c)
output: | "west-east": delref @0x7f37fea9da78(3->2) "west-east" #3:  (dispatch() +2450 programs/pluto/routing.c)
output: | "west-east" #3: releasing whack (but there are none) (teardown_ike() +1290 programs/pluto/routing.c)
output: | logger: delref @0x7f37fdf01fc8(1->0) (teardown_ike() +1290 programs/pluto/routing.c)
output: | in statetime_stop() and could not find #3
output: | packet from 192.1.2.23:500: delref @0x7f37fe0f3708(2->1) (process_packet_with_secured_ike_sa() +2214 programs/pluto/ikev2.c)
output: | in statetime_stop() and could not find #3
output: | packet from 192.1.2.23:500: delref @0x7f37fe0f3708(1->0) (process_iface_packet() +296 programs/pluto/demux.c)
output: | packet from 192.1.2.23:500: releasing whack (but there are none) (process_iface_packet() +296 programs/pluto/demux.c)
output: | logger: delref @0x7f37fdf74fc8(1->0) (process_iface_packet() +296 programs/pluto/demux.c)
output: | delref @0x7f37feaabf38(2->1) (process_iface_packet() +296 programs/pluto/demux.c)
output: | spent 9.44 (56.8) milliseconds in process_iface_packet() reading and processing packet
output: | processing global timer EVENT_SHUNT_SCAN
output: | kernel: checking for aged bare shunts from shunt table to expire
output: | spent 0.0123 (0.137) milliseconds in global timer EVENT_SHUNT_SCAN
output: | kernel: netlink_process_xfrm_messages() process messages
output: | netlink_get() recvfrom() returned 248 bytes
output: | netlink_xfrm_message_processor() got XFRM_MSG_EXPIRE message with length 248
output: | xfrm_kernel_sa_expire() spi 00000000 src 192.0.1.254 dst 192.0.2.254 hard mode 0 proto 50 bytes 0 packets 0
output: | acquire state with SPI SPISPI expired, ignore it
west #
 ../../guestbin/ipsec-kernel-state.sh
west #
 ../../guestbin/ipsec-kernel-policy.sh
src 192.0.1.0/24 dst 192.0.2.0/24
	dir out priority PRIORITY ptype main
	tmpl src 0.0.0.0 dst 0.0.0.0
		proto esp reqid 0 mode transport
west #
 ipsec unroute west-east
west #
 
